{"schemaVersion":1,"gitHash":"8739afb5b8b2405779bf414d1c83300291b55905","writtenAt":"2026-02-19T22:49:03.832Z","data":[{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":682,"col":18},"end":{"line":825,"col":5},"lines":"    const html = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Budget Export - ${selectedBudget.name}</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }\n          h1 { color: #1a1a1a; border-bottom: 2px solid #e5e5e5; padding-bottom: 10px; }\n          h2 { color: #4a4a4a; margin-top: 30px; }\n          .summary { background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0; }\n          .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }\n          .summary-item { text-align: center; }\n          .summary-label { font-size: 12px; color: #666; }\n          .summary-value { font-size: 24px; font-weight: bold; color: #1a1a1a; }\n          table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n          th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e5e5; }\n          th { background: #f5f5f5; font-weight: 600; }\n          .amount { text-align: right; }\n          .total-row { font-weight: bold; background: #f9f9f9; }\n          .footer { margin-top: 40px; font-size: 12px; color: #666; text-align: center; }\n        </style>\n      </head>\n      <body>\n        <h1>Budget Export</h1>\n        <h2>${selectedBudget.name}</h2>\n        <p>Period: ${new Date(selectedBudget.startDate).toLocaleDateString()} - ${new Date(selectedBudget.endDate).toLocaleDateString()}</p>\n        ${isNonprofit && linkedGrant ? `<p>Linked Grant: ${linkedGrant.name}</p>` : ''}\n        \n        <div class=\"summary\">\n          <div class=\"summary-grid\">\n            ${isNonprofit && linkedGrant ? `\n              <div class=\"summary-item\">\n                <div class=\"summary-label\">Grant Amount</div>\n                <div class=\"summary-value\">$${grantAmount.toLocaleString()}</div>\n              </div>\n            ` : ''}\n            ${additionalFunds > 0 ? `\n              <div class=\"summary-item\">\n                <div class=\"summary-label\">Additional Funds</div>\n                <div class=\"summary-value\">$${additionalFunds.toLocaleString()}</div>\n              </div>\n            ` : ''}\n            ${incomeTotal > 0 ? `\n              <div class=\"summary-item\">\n                <div class=\"summary-label\">Income Sources</div>\n                <div class=\"summary-value\">$${incomeTotal.toLocaleString()}</div>\n              </div>\n            ` : ''}\n            <div class=\"summary-item\">\n              <div class=\"summary-label\">Total Funding</div>\n              <div class=\"summary-value\">$${totalFunding.toLocaleString()}</div>\n            </div>\n            <div class=\"summary-item\">\n              <div class=\"summary-label\">Total Budgeted</div>\n              <div class=\"summary-value\">$${totalBudgeted.toLocaleString()}</div>\n            </div>\n            <div class=\"summary-item\">\n              <div class=\"summary-label\">Total Spent</div>\n              <div class=\"summary-value\">$${totalSpent.toLocaleString()}</div>\n            </div>\n          </div>\n        </div>\n        \n        ${selectedBudget.additionalFundsDescription ? `\n          <p><strong>Additional Funds Source:</strong> ${selectedBudget.additionalFundsDescription}</p>\n        ` : ''}\n        \n        ${incomeItems.length > 0 ? `\n          <h2>Income Sources</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>Source</th>\n                <th class=\"amount\">Amount</th>\n                <th>Notes</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${incomeItems.map(item => `\n                <tr>\n                  <td>${item.sourceName}</td>\n                  <td class=\"amount\">$${Number(item.amount).toLocaleString()}</td>\n                  <td>${item.notes || ''}</td>\n                </tr>\n              `).join('')}\n              <tr class=\"total-row\">\n                <td>Total Income</td>\n                <td class=\"amount\">$${incomeTotal.toLocaleString()}</td>\n                <td></td>\n              </tr>\n            </tbody>\n          </table>\n        ` : ''}\n        \n        <h2>Budget Line Items with Variance Analysis</h2>\n        <table>\n          <thead>\n            <tr>\n              <th>Category</th>\n              <th class=\"amount\">Planned</th>\n              <th class=\"amount\">Actual</th>\n              <th class=\"amount\">Variance $</th>\n              <th class=\"amount\">Variance %</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${vsActual.map(item => {\n              const budgeted = parseFloat(item.budgeted);\n              const actual = parseFloat(item.actual);\n              const variance = budgeted - actual;\n              const variancePercent = budgeted > 0 ? ((variance / budgeted) * 100) : 0;\n              const status = item.percentUsed > 100 ? 'Over Budget' : item.percentUsed >= 75 ? 'At Risk' : 'On Track';\n              const statusColor = item.percentUsed > 100 ? '#dc2626' : item.percentUsed >= 75 ? '#ca8a04' : '#16a34a';\n              const varianceColor = variance < 0 ? '#dc2626' : '#16a34a';\n              const varianceSign = variance >= 0 ? '+' : '';\n              const variancePercentColor = variancePercent < 0 ? '#dc2626' : '#16a34a';\n              const variancePercentSign = variancePercent >= 0 ? '+' : '';\n              return '<tr>' +\n                '<td>' + item.categoryName + '</td>' +\n                '<td class=\"amount\">$' + budgeted.toLocaleString() + '</td>' +\n                '<td class=\"amount\">$' + actual.toLocaleString() + '</td>' +\n                '<td class=\"amount\" style=\"color: ' + varianceColor + '\">' + varianceSign + variance.toLocaleString() + '</td>' +\n                '<td class=\"amount\" style=\"color: ' + variancePercentColor + '\">' + variancePercentSign + variancePercent.toFixed(1) + '%</td>' +\n                '<td style=\"color: ' + statusColor + '; font-weight: 500;\">' + status + '</td>' +\n                '</tr>';\n            }).join('')}\n            <tr class=\"total-row\">\n              <td>Total</td>\n              <td class=\"amount\">$${totalBudgeted.toLocaleString()}</td>\n              <td class=\"amount\">$${totalSpent.toLocaleString()}</td>\n              <td class=\"amount\" style=\"color: ${(totalBudgeted - totalSpent) < 0 ? '#dc2626' : '#16a34a'}\">${(totalBudgeted - totalSpent) >= 0 ? '+' : ''}$${(totalBudgeted - totalSpent).toLocaleString()}</td>\n              <td class=\"amount\">${totalBudgeted > 0 ? ((totalSpent / totalBudgeted) * 100).toFixed(1) : 0}%</td>\n              <td></td>\n            </tr>\n          </tbody>\n        </table>\n        \n        <div class=\"footer\">\n          <p>Generated on ${new Date().toLocaleDateString()} | ComplyBook Budget Export</p>\n        </div>\n      </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"c9c83d901db586ed6d89342c3f7655c58050f54908c01dafa4fe449d27b36a1d237cc97f848a91d618301ef35e3504e43e159d8f03fd0cf5cce65037e474c256_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":708,"col":40},"end":{"line":708,"col":81},"lines":"        ${isNonprofit && linkedGrant ? `<p>Linked Grant: ${linkedGrant.name}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"ef5add05889f217eec85b74434c20386b71231dce4c96bf61666531e0933d295fe7b2433f228c1fe7af99d958f665072e9f9dd1b913fa2f309f5ad03b98c8abe_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":712,"col":44},"end":{"line":717,"col":13},"lines":"            ${isNonprofit && linkedGrant ? `\n              <div class=\"summary-item\">\n                <div class=\"summary-label\">Grant Amount</div>\n                <div class=\"summary-value\">$${grantAmount.toLocaleString()}</div>\n              </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"7a9260c883a3dc65a598cb55c51074726365f383db60cfd653b3d6a93e430f0c968443ec721e7a20768fedd5bf746e77012fbd8c992f90dca4ef91355575321d_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":718,"col":37},"end":{"line":723,"col":13},"lines":"            ${additionalFunds > 0 ? `\n              <div class=\"summary-item\">\n                <div class=\"summary-label\">Additional Funds</div>\n                <div class=\"summary-value\">$${additionalFunds.toLocaleString()}</div>\n              </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"90afbb5f12fdbc50ff27e9fbca8724292272898de4a212d9a8db889bc6df3a79d8519a42881751f6aa58268c0cb18f3d600f60e99ca1e7947053aa1a60c9365f_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":724,"col":33},"end":{"line":729,"col":13},"lines":"            ${incomeTotal > 0 ? `\n              <div class=\"summary-item\">\n                <div class=\"summary-label\">Income Sources</div>\n                <div class=\"summary-value\">$${incomeTotal.toLocaleString()}</div>\n              </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"84a21af46147e43da9f636c434398540cd770f80d2f77256d4a4c41d7c4376a7c970a7b8599e4b9690d21fe0d713113936159353994a21615f6cb162ec67046a_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":745,"col":55},"end":{"line":747,"col":9},"lines":"        ${selectedBudget.additionalFundsDescription ? `\n          <p><strong>Additional Funds Source:</strong> ${selectedBudget.additionalFundsDescription}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"72bebbfc5809d6743463d9df477d89508e48297eaa3e1aff57daab3fd56f19eec5ef7a8a64e735abbfb51187c653cf76e8c9e512d5d0fbc0e8e8a75fdd3db390_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":749,"col":36},"end":{"line":774,"col":9},"lines":"        ${incomeItems.length > 0 ? `\n          <h2>Income Sources</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>Source</th>\n                <th class=\"amount\">Amount</th>\n                <th>Notes</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${incomeItems.map(item => `\n                <tr>\n                  <td>${item.sourceName}</td>\n                  <td class=\"amount\">$${Number(item.amount).toLocaleString()}</td>\n                  <td>${item.notes || ''}</td>\n                </tr>\n              `).join('')}\n              <tr class=\"total-row\">\n                <td>Total Income</td>\n                <td class=\"amount\">$${incomeTotal.toLocaleString()}</td>\n                <td></td>\n              </tr>\n            </tbody>\n          </table>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"2f0f9ece9b35f41a2be1e7956143dce602a113aa19926e85194eec1c26729fe26d7232487d1cdc0d6dcaccdfa6e7957e78f51fa7ad7393e47609178313bdb90b_0"},{"location":{"path":"client/src/pages/budgets.tsx","start":{"line":760,"col":41},"end":{"line":766,"col":15},"lines":"              ${incomeItems.map(item => `\n                <tr>\n                  <td>${item.sourceName}</td>\n                  <td class=\"amount\">$${Number(item.amount).toLocaleString()}</td>\n                  <td>${item.notes || ''}</td>\n                </tr>\n              `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"513f6471799b46f39266d006279c9bcc112b1dca27f043cc79cdf136b16e641b5b6c072c3778959909a1f1d9264f8cfa1633bc77dfbd3f3972397d7258b1e7f5_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":495,"col":9},"end":{"line":495,"col":154},"lines":"      ? `<img src=\"${currentOrganization.logoUrl}\" alt=\"Logo\" width=\"180\" style=\"display: block; max-width: 180px; height: auto; margin-bottom: 10px;\" />` "},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6b8b2ef98663f10b4a87c0c8ea9790b08b9e8e2b14b841be799a911d1c1c97a336fc0531dd16d30c3342e58d65395f6546ddea4d92e36d71938e5a40525a8dc0_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":531,"col":67},"end":{"line":531,"col":83},"lines":"    const tableHeaders = Object.keys(reportResults[0]).map(key => `<th>${key}</th>`).join('');"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"fe0d1e654776403a2fb61a21b3db1b1e2e8d1ea82208868fc87de5fcca34bff4987aa112f2dbd824be8713c0f195672475b8db6f0ac58995bc99cdca5f427675_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":538,"col":16},"end":{"line":538,"col":82},"lines":"        return `<td class=\"${isAmountField ? 'amount' : ''}\">${displayValue}</td>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"4a1deae86a669ba532a0740d26921395206dc2855bb3a27fb43309993d9a5b8cbe445454f96ec4ce1a70039e1920138b6663522e0c95fd8e6da534a7854e842e_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":540,"col":14},"end":{"line":540,"col":32},"lines":"      return `<tr>${cells}</tr>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"9acf1a51aabe9e0569189c32c6f6b073f995c8b08e1d4dc74aefd720ab269182a6c9c6bbbcb6ea4fc856ac82b6e05d4fc16f1d58be552dc9c60517dda3f5d1fa_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":546,"col":21},"end":{"line":553,"col":7},"lines":"      summaryHtml = `\n        <div class=\"summary\">\n          <h2>Summary</h2>\n          <div class=\"summary-row\"><span>Total Income:</span><span class=\"income\">${formatAmount(totalIncome)}</span></div>\n          <div class=\"summary-row\"><span>Total Expenses:</span><span class=\"expense\">${formatAmount(totalExpenses)}</span></div>\n          <div class=\"summary-row total\"><span>Net Amount:</span><span class=\"${netAmount >= 0 ? 'income' : 'expense'}\">${formatAmount(netAmount)}</span></div>\n        </div>\n      `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"1ff0e4dbc5a9112505a6c041dac5680aa78338965f104697d46a04ef75d8f8d9dca2a355f3966d5798fa7ab8e857c7ad99d491b3055ea7134483fd7ad48c9ea1_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":555,"col":21},"end":{"line":560,"col":7},"lines":"      summaryHtml = `\n        <div class=\"summary\">\n          <h2>Summary</h2>\n          <div class=\"summary-row total\"><span>Total:</span><span>${formatAmount(totalAmount)}</span></div>\n        </div>\n      `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"84ad13ff41fd586a45a5b8814d6d6ffc512da6a8e0bc02ad3a6d1f3241208b84325b30b760d09ea1d3d7de9f8be0132defc46a2b5c0972492cb1599ba5828bad_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":564,"col":9},"end":{"line":564,"col":72},"lines":"      ? `<div class=\"footer\">${currentOrganization.invoiceFooter}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"317cd435710b3d747d1bf06098630302f5ee4932c8c398b21ef502fa29577a518cb3475b7510f1ce06d2d8ed96ba8a706cb9283243263fed406a4a10ceb7fb72_0"},{"location":{"path":"client/src/pages/custom-reports.tsx","start":{"line":597,"col":45},"end":{"line":597,"col":107},"lines":"            ${executingReport.description ? `<div class=\"description\">${executingReport.description}</div>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"99c87753589922f255fd610d7141430fb8334d99e7ab866cbaee3f10a234a5057c010f0e12a519ea7af3f06c857596c6f283eb655439ddffd62165876d410d22_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":157,"col":12},"end":{"line":291,"col":5},"lines":"    return `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <style>\n          * { box-sizing: border-box; }\n          body {\n            font-family: ${fontFamily};\n            font-size: 11pt;\n            line-height: 1.6;\n            color: #1a1a1a;\n            margin: 0;\n            padding: 40px 48px;\n          }\n          table { border-collapse: collapse; }\n          \n          /* Top header - logo and contact */\n          .top-header {\n            width: 100%;\n            margin-bottom: 40px;\n          }\n          .logo-cell {\n            vertical-align: middle;\n            width: 60px;\n          }\n          .contact-cell {\n            vertical-align: middle;\n            text-align: right;\n            font-size: 9pt;\n            color: #666;\n            line-height: 1.5;\n          }\n          \n          /* Letter body */\n          .letter-body {\n            margin-top: 32px;\n          }\n          \n          .date-text {\n            font-size: 11pt;\n            color: #333;\n          }\n          \n          /* Letter content */\n          .salutation {\n            margin-bottom: 24px;\n            padding-bottom: 8px;\n          }\n          .paragraph {\n            margin: 0;\n            padding-bottom: 20px;\n            line-height: 1.8;\n          }\n          .amount-highlight {\n            font-weight: 600;\n          }\n          .tax-info {\n            margin: 0;\n            padding: 16px 0 20px 0;\n            font-size: 10pt;\n            color: #666;\n            font-style: italic;\n          }\n          .closing {\n            margin-top: 24px;\n            padding-top: 8px;\n          }\n          .closing-text {\n            margin-bottom: 20px;\n          }\n          .signature-name {\n            font-weight: 600;\n          }\n        </style>\n      </head>\n      <body>\n        <!-- Top Header: Logo on left, Contact on right -->\n        <table class=\"top-header\">\n          <tr>\n            <td class=\"logo-cell\">\n              ${logoUrl \n                ? `<img src=\"${logoUrl}\" width=\"48\" height=\"48\" style=\"width:48px;height:48px;max-width:48px;max-height:48px;object-fit:contain;display:block;\" alt=\"\" />`\n                : `<div style=\"font-size:20pt;font-weight:700;color:${primaryColor};\">${(currentOrganization.companyName || currentOrganization.name).substring(0,2).toUpperCase()}</div>`\n              }\n            </td>\n            <td class=\"contact-cell\">\n              ${currentOrganization.companyPhone ? `${currentOrganization.companyPhone}<br/>` : ''}\n              ${currentOrganization.companyEmail ? `${currentOrganization.companyEmail}<br/>` : ''}\n              ${currentOrganization.companyAddress ? currentOrganization.companyAddress.replace(/\\n/g, '<br/>') : ''}\n            </td>\n          </tr>\n        </table>\n\n        <!-- Letter Content -->\n        <div class=\"letter-body\">\n          <div class=\"date-text\">${currentDate}</div>\n          <br/>\n          \n          <div class=\"salutation\">Dear ${selectedDonor.name},</div>\n          <br/>\n\n              <div class=\"paragraph\">\n                Thank you for your generous support of ${currentOrganization.companyName || currentOrganization.name}. Your commitment to our mission makes a meaningful difference in the communities we serve.\n              </div>\n              <br/>\n\n              <div class=\"paragraph\">\n                This letter acknowledges your charitable contribution of <span class=\"amount-highlight\">${formatCurrency(selectedAmount)}</span> during the ${selectedYear} tax year. Please retain this document for your tax records.\n              </div>\n              <br/>\n\n              <div class=\"paragraph\">\n                Your generosity enables us to continue our important work and expand our reach. We are truly grateful for your partnership and trust in our organization.\n              </div>\n              <br/>\n\n              <div class=\"tax-info\">\n                ${currentOrganization.companyName || currentOrganization.name} is a 501(c)(3) tax-exempt organization${currentOrganization.taxId ? ` (EIN: ${currentOrganization.taxId})` : ''}. No goods or services were provided in exchange for this contribution.\n              </div>\n              <br/>\n\n              <div class=\"paragraph\">\n                On behalf of everyone at ${currentOrganization.companyName || currentOrganization.name}, thank you for your continued support.\n              </div>\n              <br/><br/>\n\n          <div class=\"closing\">\n            <div class=\"closing-text\">Sincerely,</div>\n            <div class=\"signature-name\">${currentOrganization.companyName || currentOrganization.name}</div>\n          </div>\n        </div>\n      </body>\n      </html>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"35b30206695637ae874b7cda854e105f02fce2b83cf533d39f0ede5d816a5b2afb12f79c90ece1eeb36db03987cb9a5f21dc87b0ecd4d1fdb79edfa7dc95bf63_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":239,"col":19},"end":{"line":239,"col":170},"lines":"                ? `<img src=\"${logoUrl}\" width=\"48\" height=\"48\" style=\"width:48px;height:48px;max-width:48px;max-height:48px;object-fit:contain;display:block;\" alt=\"\" />`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"816bb8a1b1f1c513b70d1be9a0f39d0a74e3bbf8488ba1f884dcbc4b300a9b0ecea8b01c16197fb85b66652c10cc0d4dff5cb9c4b339763dbfd687684e9f55f3_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":240,"col":19},"end":{"line":240,"col":186},"lines":"                : `<div style=\"font-size:20pt;font-weight:700;color:${primaryColor};\">${(currentOrganization.companyName || currentOrganization.name).substring(0,2).toUpperCase()}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"4aa3dc53e4702e403ce24ac6900502542778744ae06cac3556ba1f093f391b9f8315600a5bbef1bcc75e808f950dca4d3e1746e9940e36db93c73abc099780f1_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":244,"col":52},"end":{"line":244,"col":93},"lines":"              ${currentOrganization.companyPhone ? `${currentOrganization.companyPhone}<br/>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"4d12a14641c589b9ab6128b873118c5709e933004c57e2f012a9512e953da3efe18a6abd0f76b353b15f4efb4a20b1df8a59e46e76e7f84312868f6989010ad4_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":245,"col":52},"end":{"line":245,"col":93},"lines":"              ${currentOrganization.companyEmail ? `${currentOrganization.companyEmail}<br/>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"fdc6ff8fa57714ce7ece893a84352fec75cf3b67fb2374f44e74ff70fd0908e5cd81d5fb5fa5c2c1d5348e5b6d8702742b0ee637dcbeeec4d364f096b6a8275a_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":368,"col":19},"end":{"line":368,"col":170},"lines":"                ? `<img src=\"${logoUrl}\" width=\"48\" height=\"48\" style=\"width:48px;height:48px;max-width:48px;max-height:48px;object-fit:contain;display:block;\" alt=\"\" />`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"816bb8a1b1f1c513b70d1be9a0f39d0a74e3bbf8488ba1f884dcbc4b300a9b0ecea8b01c16197fb85b66652c10cc0d4dff5cb9c4b339763dbfd687684e9f55f3_1"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":369,"col":19},"end":{"line":369,"col":186},"lines":"                : `<div style=\"font-size:20pt;font-weight:700;color:${primaryColor};\">${(currentOrganization.companyName || currentOrganization.name).substring(0,2).toUpperCase()}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"4aa3dc53e4702e403ce24ac6900502542778744ae06cac3556ba1f093f391b9f8315600a5bbef1bcc75e808f950dca4d3e1746e9940e36db93c73abc099780f1_1"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":373,"col":52},"end":{"line":373,"col":93},"lines":"              ${currentOrganization.companyPhone ? `${currentOrganization.companyPhone}<br/>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"4d12a14641c589b9ab6128b873118c5709e933004c57e2f012a9512e953da3efe18a6abd0f76b353b15f4efb4a20b1df8a59e46e76e7f84312868f6989010ad4_1"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":374,"col":52},"end":{"line":374,"col":93},"lines":"              ${currentOrganization.companyEmail ? `${currentOrganization.companyEmail}<br/>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"fdc6ff8fa57714ce7ece893a84352fec75cf3b67fb2374f44e74ff70fd0908e5cd81d5fb5fa5c2c1d5348e5b6d8702742b0ee637dcbeeec4d364f096b6a8275a_1"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":409,"col":22},"end":{"line":409,"col":225},"lines":"      sampleOpening: `<p>Dear ${donorName},</p>\\n\\n<p>I hope this letter finds you well. On behalf of everyone at ${orgName}, I wanted to take a moment to personally thank you for your generous contribution of ${amount}.</p>`,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"f58767ae5e5aa129a013042c3d0f7d0cfb8a95f47e21f4b48767aceced338fc68db07af558074cfbe902bdb88f59457afa4544bb0e87846311d91bff60efd266_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":410,"col":19},"end":{"line":410,"col":407},"lines":"      sampleBody: `<p>Your support has made a real difference in our community. [Share a specific impact story or outcome here - for example: \"Thanks to donors like you, we were able to serve 50 more families this quarter\" or \"Your gift helped fund our new education program.\"]</p>\\n\\n<p>We are so grateful to have you as part of our ${orgName} family. Your belief in our mission inspires us every day.</p>`,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"86025b09af69cfc3464a3a000f7adba8fc1edaaab279c72607ad9fffb6781169eeaeebae9f64c7e1f0113c5073e47dbe65d0cd39b42cdb1c0c3ea830d985df8c_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":411,"col":22},"end":{"line":411,"col":111},"lines":"      sampleClosing: `<p>With heartfelt thanks,</p>\\n\\n<p><strong>${orgName}</strong><br/>Development Team</p>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"c56466f032b35b5ad6d3bba778f938628cbd849134ad971b1ee1510cdd2527cc2ea4fce9048038b03bf467b365381dd7d38e929f8be4f1aa5ae26d7deb9b28f4_0"},{"location":{"path":"client/src/pages/donation-letters.tsx","start":{"line":781,"col":34},"end":{"line":781,"col":239},"lines":"                    placeholder={`<p>Dear ${selectedDonor?.name || 'Donor'},</p>\\n\\n<p>Thank you for your generous support...</p>\\n\\n<p>Sincerely,</p>\\n<p><strong>${currentOrganization.companyName || currentOrganization.name}</strong></p>`}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"ead113f269180c498fc9352e6f1cc2539519511023d8b1ac392d5397da1f78327455d7640a12695817715af44dc60644c71c3649a4900466776b82d91b6a4ae2_0"},{"location":{"path":"client/src/pages/donor-portal.tsx","start":{"line":164,"col":32},"end":{"line":164,"col":48},"lines":"        window.location.href = data.checkoutUrl;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.browser.security.js-open-redirect-from-function","message":"The application accepts potentially user-controlled input `data` which can control the location of the current window context. This can lead two types of vulnerabilities open-redirection and Cross-Site-Scripting (XSS) with JavaScript URIs. It is recommended to validate user-controllable input before allowing it to control the redirection.","severity":"LOW","fingerprint":"085f157bf7c2728628df5db8c0d4398d4a06d6c074831439ec69fd10b4434fdc6dc24e0b644a497f3825e47d74850681f2704719fb7334ef23841d0711168a7e_0"},{"location":{"path":"client/src/pages/functional-expense-report.tsx","start":{"line":98,"col":9},"end":{"line":98,"col":207},"lines":"      ? `<img src=\"${currentOrganization.logoUrl}\" alt=\"Logo\" width=\"180\" style=\"display: block; max-width: 180px; max-height: 60px; width: 180px; height: auto; object-fit: contain; margin-bottom: 10px;\" />` "},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"2675bd8b3201dd6c0333367d3c5b556a1cd4fe13595dec434d24fe3678479a9483257bbd421367224a843a38707c2c1caaae967ad77bf2ed17dec3018e494e8d_0"},{"location":{"path":"client/src/pages/functional-expense-report.tsx","start":{"line":103,"col":9},"end":{"line":103,"col":180},"lines":"      ? `<div style=\"border-top: 1px solid #ddd; padding-top: 20px; margin-top: 40px; text-align: center; font-size: 10px; color: #888; white-space: pre-line;\">${footerText}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"7a0a25b0335699fca7f3eab4f98d591adc9e2ca6b5be9d8dec866fb704cbb15718e68164718c310a9e722a1150b4cbe3c5e4ed75a5705bf2f2833969c19eb024_0"},{"location":{"path":"client/src/pages/functional-expense-report.tsx","start":{"line":188,"col":57},"end":{"line":193,"col":17},"lines":"                ${reportData.expensesByProgram.map(p => `\n                  <tr>\n                    <td>${p.programName}</td>\n                    <td class=\"amount\">${formatCurrency(p.amount)}</td>\n                  </tr>\n                `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"5bcf53a8a2dfdc91a6de2f0fef0d9d7e66686a962bd9aead48d6467f3fc9e590c1b54dadc831013e445c64d1aa05a97b7e589b26aff316abc133554b09046782_0"},{"location":{"path":"client/src/pages/functional-expense-report.tsx","start":{"line":209,"col":58},"end":{"line":215,"col":17},"lines":"                ${reportData.expensesByCategory.map(c => `\n                  <tr>\n                    <td>${c.functionalCategory}</td>\n                    <td>${c.categoryName}</td>\n                    <td class=\"amount\">${formatCurrency(c.amount)}</td>\n                  </tr>\n                `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"178b503d7969208f957d8719f656c1d32409abf36706f7c84309e9d1e1870d5d1c739f21038c923b6168763630a8b9fdd4d445fff529c098dc9dde3e9d94d19f_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":424,"col":60},"end":{"line":424,"col":115},"lines":"    const placeholder = (text: string = 'Not captured') => `<em style=\"color: #999; font-size: 11px;\">${text}</em>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"c54ef03ee8219cd7ea63817be741f47eb2b45746f05da46cfc7660e3a9150d2195ca798294a52ba577b3809e0649d421feeeaa03273844731bda3df6d78a1f54_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":433,"col":24},"end":{"line":699,"col":5},"lines":"    const pdfContent = `\n      <div style=\"font-family: Arial, sans-serif; padding: 30px; max-width: 850px; margin: 0 auto; font-size: 11px;\">\n        <!-- Header -->\n        <div style=\"text-align: center; margin-bottom: 20px; border-bottom: 3px solid #000; padding-bottom: 15px;\">\n          <h1 style=\"font-size: 18px; margin: 0 0 5px 0; font-weight: bold;\">FEDERAL FINANCIAL REPORT</h1>\n          <p style=\"margin: 0; font-size: 10px;\">(Follow form instructions)</p>\n          <p style=\"margin: 5px 0 0 0; font-size: 10px;\"><strong>OMB Approval Number: 0348-0061</strong></p>\n          <p style=\"margin: 3px 0 0 0; font-size: 9px; font-style: italic;\">Expiration Date: 02/28/2025</p>\n        </div>\n\n        <!-- Section 1-9: Identification Information -->\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 15px;\">\n          <tr>\n            <td style=\"border: 1px solid #000; padding: 8px; width: 70%; vertical-align: top;\">\n              <strong>1. Federal Agency and Organizational Element to Which Report is Submitted:</strong><br/>\n              ${currentOrganization.name}\n            </td>\n            <td style=\"border: 1px solid #000; padding: 8px; vertical-align: top;\">\n              <strong>2. Federal Grant or Other Identifying Number Assigned by Federal Agency:</strong><br/>\n              ${grant?.name || placeholder()}\n            </td>\n          </tr>\n        </table>\n\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 15px;\">\n          <tr>\n            <td style=\"border: 1px solid #000; padding: 8px; width: 70%; vertical-align: top;\">\n              <strong>3. Recipient Organization (Name and complete address including Zip code):</strong><br/>\n              ${currentOrganization.name}<br/>\n              ${placeholder('Address not captured')}\n            </td>\n            <td style=\"border: 1px solid #000; padding: 8px; vertical-align: top;\">\n              <strong>4a. UEI:</strong><br/>\n              ${placeholder('Not captured')}<br/><br/>\n              <strong>4b. EIN:</strong><br/>\n              ${placeholder('Not captured')}\n            </td>\n          </tr>\n        </table>\n\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 15px;\">\n          <tr>\n            <td style=\"border: 1px solid #000; padding: 8px; width: 35%; vertical-align: top;\">\n              <strong>5. Recipient Account Number or Identifying Number:</strong><br/>\n              ${placeholder('Optional')}\n            </td>\n            <td style=\"border: 1px solid #000; padding: 8px; width: 30%; vertical-align: top;\">\n              <strong>6. Report Type:</strong><br/>\n              ☐ Quarterly<br/>\n              ☐ Semi-Annual<br/>\n              ☐ Annual<br/>\n              ☐ Final\n            </td>\n            <td style=\"border: 1px solid #000; padding: 8px; vertical-align: top;\">\n              <strong>7. Basis of Accounting:</strong><br/>\n              ☐ Cash<br/>\n              ☐ Accrual\n            </td>\n          </tr>\n        </table>\n\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #000; padding: 8px; width: 50%; vertical-align: top;\">\n              <strong>8. Project/Grant Period:</strong><br/>\n              From: ${formatDate(grant?.startDate)} &nbsp;&nbsp; To: ${formatDate(grant?.endDate)}\n            </td>\n            <td style=\"border: 1px solid #000; padding: 8px; vertical-align: top;\">\n              <strong>9. Reporting Period End Date (MM/DD/YYYY):</strong><br/>\n              ${formatDate(report.reportingPeriodEnd)}\n            </td>\n          </tr>\n        </table>\n\n        <!-- Section 10: Transactions (Federal Cash) -->\n        <div style=\"margin-bottom: 20px;\">\n          <h3 style=\"background-color: #e0e0e0; padding: 8px; margin: 0 0 10px 0; font-size: 12px; font-weight: bold; border: 1px solid #000;\">10. TRANSACTIONS</h3>\n          \n          <table style=\"width: 100%; border-collapse: collapse; font-size: 10px;\">\n            <tr style=\"background-color: #f5f5f5;\">\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 60%;\">Description</td>\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; text-align: right;\">Amount</td>\n            </tr>\n            \n            <!-- 10a-c: Cash Status -->\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>a.</strong> Cash Receipts:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Not tracked')}</td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>b.</strong> Cash Disbursements:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Not tracked')}</td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>c.</strong> Cash on Hand (line a minus line b):</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Cannot calculate')}</td>\n            </tr>\n            \n            <!-- 10d-h: Federal Expenditures and Balance -->\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>d.</strong> Total Federal funds authorized:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Not tracked')}</td>\n            </tr>\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>e.</strong> Federal share of expenditures:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${formatCurrency(report.federalShareExpenditure)}</td>\n            </tr>\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>f.</strong> Federal share of unliquidated obligations:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${formatCurrency(report.unliquidatedObligations)}</td>\n            </tr>\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>g.</strong> Total Federal share (sum of lines e and f):</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right; font-weight: bold;\">${formatCurrency(totalFederalShare)}</td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>h.</strong> Unobligated balance of Federal funds (line d minus line g):</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Cannot calculate')}</td>\n            </tr>\n            \n            <!-- 10i-k: Recipient Share -->\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>i.</strong> Total recipient share required:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Not tracked')}</td>\n            </tr>\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>j.</strong> Recipient share of expenditures:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${formatCurrency(report.recipientShareExpenditure)}</td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>k.</strong> Remaining recipient share to be provided (line i minus line j):</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Cannot calculate')}</td>\n            </tr>\n            \n            <!-- 10l-o: Program Income -->\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>l.</strong> Total Federal program income earned:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${formatCurrency(report.programIncomeEarned)}</td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>m.</strong> Program income expended in accordance with the deduction alternative:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${placeholder('Not applicable')}</td>\n            </tr>\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>n.</strong> Program income expended in accordance with the addition alternative:</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right;\">${formatCurrency(report.programIncomeExpended)}</td>\n            </tr>\n            <tr>\n              <td style=\"border: 1px solid #000; padding: 6px;\"><strong>o.</strong> Unexpended program income (line l minus line m or line n):</td>\n              <td style=\"border: 1px solid #000; padding: 6px; text-align: right; font-weight: bold;\">${formatCurrency(unexpendedProgramIncome)}</td>\n            </tr>\n          </table>\n          <p style=\"margin-top: 8px; font-size: 9px; color: #666; font-style: italic;\">\n            <span style=\"background-color: #fffacd; padding: 2px 4px;\">Highlighted</span> fields are not captured in system database. Complete manually for official submission.\n          </p>\n        </div>\n\n        <!-- Section 11: Indirect Expense -->\n        <div style=\"margin-bottom: 20px;\">\n          <h3 style=\"background-color: #e0e0e0; padding: 8px; margin: 0 0 10px 0; font-size: 12px; font-weight: bold; border: 1px solid #000;\">11. INDIRECT EXPENSE</h3>\n          <table style=\"width: 100%; border-collapse: collapse; font-size: 10px;\">\n            <tr style=\"background-color: #f5f5f5;\">\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 15%;\">a. Type</td>\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 10%;\">b. Rate</td>\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 20%;\">c. Period (From/To)</td>\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 20%;\">d. Base</td>\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 20%;\">e. Amount Charged</td>\n              <td style=\"border: 1px solid #000; padding: 6px; font-weight: bold; width: 15%;\">f. Federal Share</td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 6px;\">${placeholder()}</td>\n              <td style=\"border: 1px solid #000; padding: 6px;\">${placeholder()}</td>\n              <td style=\"border: 1px solid #000; padding: 6px;\">${placeholder()}</td>\n              <td style=\"border: 1px solid #000; padding: 6px;\">${placeholder()}</td>\n              <td style=\"border: 1px solid #000; padding: 6px;\">${placeholder()}</td>\n              <td style=\"border: 1px solid #000; padding: 6px;\">${placeholder()}</td>\n            </tr>\n          </table>\n          <p style=\"margin-top: 5px; font-size: 9px; color: #666; font-style: italic;\">\n            Indirect expense information not captured in system. Complete manually for official submission.\n          </p>\n        </div>\n\n        <!-- Section 12: Remarks -->\n        ${report.notes ? `\n        <div style=\"margin-bottom: 20px;\">\n          <h3 style=\"background-color: #e0e0e0; padding: 8px; margin: 0 0 10px 0; font-size: 12px; font-weight: bold; border: 1px solid #000;\">12. REMARKS</h3>\n          <div style=\"border: 1px solid #000; padding: 10px; min-height: 60px; font-size: 10px;\">\n            ${report.notes}\n          </div>\n          <p style=\"margin-top: 5px; font-size: 9px; color: #666; font-style: italic;\">\n            Attach additional documentation as needed to explain unliquidated obligations and other transactions.\n          </p>\n        </div>\n        ` : `\n        <div style=\"margin-bottom: 20px;\">\n          <h3 style=\"background-color: #e0e0e0; padding: 8px; margin: 0 0 10px 0; font-size: 12px; font-weight: bold; border: 1px solid #000;\">12. REMARKS</h3>\n          <div style=\"border: 1px solid #000; padding: 10px; min-height: 60px; font-size: 10px; color: #999;\">\n            <em>No remarks provided. Attach additional documentation as needed.</em>\n          </div>\n        </div>\n        `}\n\n        <!-- Section 13: Certification -->\n        <div style=\"margin-bottom: 20px; page-break-inside: avoid;\">\n          <h3 style=\"background-color: #e0e0e0; padding: 8px; margin: 0 0 10px 0; font-size: 12px; font-weight: bold; border: 1px solid #000;\">13. CERTIFICATION</h3>\n          <p style=\"font-size: 10px; line-height: 1.5; margin-bottom: 15px; border: 1px solid #000; padding: 10px; background-color: #f9f9f9;\">\n            <strong>By signing this report, I certify to the best of my knowledge and belief that the report is true, complete, and accurate, and the expenditures, disbursements and cash receipts are for the purposes and objectives set forth in the award documents.</strong> I am aware that any false, fictitious, or fraudulent information may subject me to criminal, civil, or administrative penalties. (U.S. Code, Title 18, Section 1001)\n          </p>\n          \n          <table style=\"width: 100%; border-collapse: collapse; font-size: 10px;\">\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 8px; width: 70%;\">\n                <strong>13a. Typed or Printed Name and Title of Authorized Certifying Official:</strong><br/><br/>\n                ${placeholder('Complete manually before submission')}\n              </td>\n              <td style=\"border: 1px solid #000; padding: 8px; vertical-align: top;\">\n                <strong>13c. Telephone:</strong><br/><br/>\n                ${placeholder()}\n              </td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td style=\"border: 1px solid #000; padding: 8px;\">\n                <strong>13b. Signature of Authorized Certifying Official:</strong><br/><br/>\n                ${placeholder('Signature required')}\n              </td>\n              <td style=\"border: 1px solid #000; padding: 8px; vertical-align: top;\">\n                <strong>13d. Email Address:</strong><br/><br/>\n                ${placeholder()}\n              </td>\n            </tr>\n            <tr style=\"background-color: #fffacd;\">\n              <td colspan=\"2\" style=\"border: 1px solid #000; padding: 8px;\">\n                <strong>13e. Date Report Submitted (MM/DD/YYYY):</strong><br/><br/>\n                ${formatDate(report.submittedDate) || placeholder('Not yet submitted')}\n              </td>\n            </tr>\n          </table>\n        </div>\n\n        <!-- Section 14: Agency Use Only -->\n        <div style=\"margin-bottom: 30px;\">\n          <h3 style=\"background-color: #e0e0e0; padding: 8px; margin: 0 0 10px 0; font-size: 12px; font-weight: bold; border: 1px solid #000;\">14. AGENCY USE ONLY</h3>\n          <div style=\"border: 1px solid #000; padding: 10px; min-height: 40px; background-color: #f0f0f0;\">\n            <em style=\"font-size: 9px; color: #666;\">Reserved for federal agency use</em>\n          </div>\n        </div>\n\n        <!-- Paperwork Reduction Notice -->\n        <div style=\"border-top: 2px solid #000; padding-top: 15px; margin-top: 30px;\">\n          <p style=\"font-size: 8px; line-height: 1.4; color: #444; text-align: justify;\">\n            <strong>Paperwork Reduction Act Statement:</strong> According to the Paperwork Reduction Act, as amended, no persons are required to respond to a collection of information unless it displays a valid OMB Control Number. The valid OMB control number for this information collection is 0348-0061. Public reporting burden for this collection of information is estimated to average 1.5 hours per response, including time for reviewing instructions, searching existing data sources, gathering and maintaining the data needed, and completing and reviewing the collection of information. Send comments regarding the burden estimate or any other aspect of this collection of information, including suggestions for reducing this burden, to the Office of Management and Budget, Paperwork Reduction Project (0348-0061), Washington, DC 20503.\n          </p>\n        </div>\n\n        <!-- Generation Footer -->\n        <div style=\"margin-top: 20px; text-align: center; border-top: 1px solid #ccc; padding-top: 10px;\">\n          <p style=\"font-size: 9px; color: #666;\">\n            <strong>SF-425 Federal Financial Report</strong><br/>\n            Generated: ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}<br/>\n            Organization: ${currentOrganization.name}<br/>\n            Report Period Ending: ${formatDate(report.reportingPeriodEnd)}<br/>\n            <em style=\"font-size: 8px;\">This export contains data from the ComplyBook system. Yellow highlighted fields require manual completion before official submission.</em>\n          </p>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"591a05a96ccda27e466d451c653bb3a10640e1d3daa60621454edcaca4490ce9437c3680eddb38220455b1dfec612b139780c2dd20923dcefde2a30c599266bf_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":729,"col":24},"end":{"line":796,"col":5},"lines":"    const pdfContent = `\n      <div style=\"font-family: Arial, sans-serif; padding: 30px; max-width: 850px; margin: 0 auto;\">\n        <div style=\"text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 15px;\">\n          <h1 style=\"font-size: 20px; margin: 0; color: #333;\">TIME AND EFFORT CERTIFICATION REPORT</h1>\n          <p style=\"margin: 10px 0 0 0; font-size: 12px; color: #666;\">Federal Grant Compliance Documentation</p>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Organization:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${currentOrganization.name}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Grant:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${grant?.name || 'N/A'}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Employee ID:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${report.employeeId}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Reporting Period:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(report.reportingPeriodStart)} - ${formatDate(report.reportingPeriodEnd)}</td>\n          </tr>\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Effort Distribution</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Total Hours:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${report.totalHours}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Grant Hours:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${report.grantHours}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Other Activities Hours:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${report.otherActivitiesHours || 0}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Percentage Effort:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; font-weight: bold; color: #0066cc;\">${report.percentageEffort}%</td>\n          </tr>\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Certification</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Certified By:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${report.certifiedBy || 'Pending'}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Certification Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(report.certificationDate)}</td>\n          </tr>\n        </table>\n        \n        ${report.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${report.notes}</p>\n        ` : ''}\n        \n        <div style=\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 10px; color: #999;\">\n          <p>Generated by ComplyBook on ${new Date().toLocaleString()}</p>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"a2fee62f0f97057dc305f9e90fe999e351e094ff6c8a1eb1ce27c8bb55195764dcd0bc37f6848a14d9387a302d8b1623da0a8802faccc9bc83e9f60c969b1882_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":787,"col":26},"end":{"line":790,"col":9},"lines":"        ${report.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${report.notes}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6e5d0a812d8977e702c7020c90ddb75909c3576c9da30884a6e95c0b496e62ee561716509ea9702f7bf22a22b663479932dbaf77b191ff14bc2ef534a7d722c7_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":828,"col":24},"end":{"line":886,"col":5},"lines":"    const pdfContent = `\n      <div style=\"font-family: Arial, sans-serif; padding: 30px; max-width: 850px; margin: 0 auto;\">\n        <div style=\"text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 15px;\">\n          <h1 style=\"font-size: 20px; margin: 0; color: #333;\">COST ALLOWABILITY DETERMINATION</h1>\n          <p style=\"margin: 10px 0 0 0; font-size: 12px; color: #666;\">2 CFR Part 200 Compliance Review</p>\n        </div>\n        \n        <div style=\"text-align: center; margin-bottom: 20px;\">\n          <span style=\"display: inline-block; padding: 10px 30px; background: ${statusColor}; color: white; font-weight: bold; border-radius: 5px; font-size: 16px;\">\n            ${check.allowabilityStatus.toUpperCase()}\n          </span>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Organization:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${currentOrganization.name}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Grant:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${grant?.name || 'N/A'}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Cost Category:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${check.costCategory}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Amount:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; font-weight: bold;\">${formatCurrency(check.amount)}</td>\n          </tr>\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Review Details</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Reviewed By:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${check.reviewedBy || 'Pending Review'}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Review Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(check.reviewDate)}</td>\n          </tr>\n        </table>\n        \n        ${check.justification ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Justification</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${check.justification}</p>\n        ` : ''}\n        \n        ${check.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${check.notes}</p>\n        ` : ''}\n        \n        <div style=\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 10px; color: #999;\">\n          <p>Generated by ComplyBook on ${new Date().toLocaleString()}</p>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"a2fee62f0f97057dc305f9e90fe999e351e094ff6c8a1eb1ce27c8bb55195764dcd0bc37f6848a14d9387a302d8b1623da0a8802faccc9bc83e9f60c969b1882_1"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":872,"col":33},"end":{"line":875,"col":9},"lines":"        ${check.justification ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Justification</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${check.justification}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"f5535431a8096ae40cd9687fe05762bc38255263c66396107da5e6433edfeb97b70e440dd1e97bfda908f2f298acaca181d4355c19731cbe8921eef47e55e186_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":877,"col":25},"end":{"line":880,"col":9},"lines":"        ${check.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${check.notes}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"04456e249559ce63a451347637f145f6f82b1288f8a71cb6fadf36e72b01397ee9ed1871db0eb5729bca91c3b42c7f1f10ed56d49607bed7fb6f42ad30c340b7_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":915,"col":24},"end":{"line":999,"col":5},"lines":"    const pdfContent = `\n      <div style=\"font-family: Arial, sans-serif; padding: 30px; max-width: 850px; margin: 0 auto;\">\n        <div style=\"text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 15px;\">\n          <h1 style=\"font-size: 20px; margin: 0; color: #333;\">SUB-RECIPIENT AWARD SUMMARY</h1>\n          <p style=\"margin: 10px 0 0 0; font-size: 12px; color: #666;\">Federal Pass-Through Monitoring</p>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Pass-Through Entity:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${currentOrganization.name}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Federal Award:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${grant?.name || 'N/A'}</td>\n          </tr>\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Sub-Recipient Information</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Sub-Recipient Name:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${award.subrecipientName}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Sub-Recipient EIN:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${award.subrecipientEIN || 'N/A'}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Award Amount:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; font-weight: bold; color: #0066cc;\">${formatCurrency(award.awardAmount)}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Status:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${award.status}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Compliance Status:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${award.complianceStatus}</td>\n          </tr>\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Award Period</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Award Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(award.awardDate)}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Start Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(award.startDate)}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>End Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(award.endDate)}</td>\n          </tr>\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Monitoring Schedule</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Last Monitoring:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(award.lastMonitoringDate)}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Next Monitoring:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(award.nextMonitoringDate)}</td>\n          </tr>\n        </table>\n        \n        ${award.purpose ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Purpose</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${award.purpose}</p>\n        ` : ''}\n        \n        ${award.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${award.notes}</p>\n        ` : ''}\n        \n        <div style=\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 10px; color: #999;\">\n          <p>Generated by ComplyBook on ${new Date().toLocaleString()}</p>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"a2fee62f0f97057dc305f9e90fe999e351e094ff6c8a1eb1ce27c8bb55195764dcd0bc37f6848a14d9387a302d8b1623da0a8802faccc9bc83e9f60c969b1882_2"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":985,"col":27},"end":{"line":988,"col":9},"lines":"        ${award.purpose ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Purpose</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${award.purpose}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"0fb4217f32c29eef3b20c276a8c0ab81ad3df5007d52858fd66876c49ab7a0f9d048aceae844d3139e9cf40ac8c1df09f5dd3ea9b418a4a22070eaf670d02cee_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":990,"col":25},"end":{"line":993,"col":9},"lines":"        ${award.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${award.notes}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"731b023116472ac6f9dc96e6430fcdf6fb9cec5768e632eea0f7f47397d4c5a7aef9c6c541900774e60c5dc6114e6926941a5e93b162d9747a763334e4b0c94a_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":1031,"col":24},"end":{"line":1104,"col":5},"lines":"    const pdfContent = `\n      <div style=\"font-family: Arial, sans-serif; padding: 30px; max-width: 850px; margin: 0 auto;\">\n        <div style=\"text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 15px;\">\n          <h1 style=\"font-size: 20px; margin: 0; color: #333;\">SINGLE AUDIT PREPARATION CHECKLIST</h1>\n          <p style=\"margin: 10px 0 0 0; font-size: 12px; color: #666;\">Fiscal Year ${item.auditYear}</p>\n        </div>\n        \n        <div style=\"text-align: center; margin-bottom: 20px;\">\n          <span style=\"display: inline-block; padding: 10px 30px; background: ${statusColor}; color: white; font-weight: bold; border-radius: 5px; font-size: 14px;\">\n            ${item.completionStatus.replace('_', ' ').toUpperCase()}\n          </span>\n        </div>\n        \n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Organization:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${currentOrganization.name}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Audit Year:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${item.auditYear}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Item Type:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${item.itemType}</td>\n          </tr>\n          ${item.grantId ? `\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Related Grant:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${grant?.name || 'N/A'}</td>\n          </tr>\n          ` : ''}\n          ${item.amount ? `\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Amount:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatCurrency(item.amount)}</td>\n          </tr>\n          ` : ''}\n        </table>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Description</h3>\n        <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${item.description}</p>\n        \n        <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Assignment & Timeline</h3>\n        <table style=\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\">\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5; width: 30%;\"><strong>Assigned To:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${item.assignedTo || 'Unassigned'}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Due Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(item.dueDate)}</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Completed Date:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatDate(item.completedDate)}</td>\n          </tr>\n        </table>\n        \n        ${item.findings ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Findings</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fff3cd;\">${item.findings}</p>\n        ` : ''}\n        \n        ${item.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${item.notes}</p>\n        ` : ''}\n        \n        <div style=\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 10px; color: #999;\">\n          <p>Generated by ComplyBook on ${new Date().toLocaleString()}</p>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"a2fee62f0f97057dc305f9e90fe999e351e094ff6c8a1eb1ce27c8bb55195764dcd0bc37f6848a14d9387a302d8b1623da0a8802faccc9bc83e9f60c969b1882_3"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":1057,"col":28},"end":{"line":1062,"col":11},"lines":"          ${item.grantId ? `\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Related Grant:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${grant?.name || 'N/A'}</td>\n          </tr>\n          ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"ebda1799b255a40677ba7f2777fd7d567ec64f53fa0b1ce61f9b5520d5f38c718100f64c90845c2d7314cde29c7992c4e2a04451d4c975f3199c3bc1a5fcfd06_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":1063,"col":27},"end":{"line":1068,"col":11},"lines":"          ${item.amount ? `\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 12px; background: #f5f5f5;\"><strong>Amount:</strong></td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">${formatCurrency(item.amount)}</td>\n          </tr>\n          ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"68830f73ec396acfd263aa4bb2b6a3a789670a8373bc4eac971932eb7ede87ed1660d83fcbcd265707b25c7bdb2c6a5063708628d3cc547c17643b922cc4510f_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":1090,"col":27},"end":{"line":1093,"col":9},"lines":"        ${item.findings ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Findings</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fff3cd;\">${item.findings}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"8874c38add804b66fb583b9d4e9b09578e425d6b06c799bc2f3a5bbdaf8cefba47d986c55cdd1fb3987f8ade55bf58834d5249901d7761d50cd74e4c1b9c0230_0"},{"location":{"path":"client/src/pages/government-grants.tsx","start":{"line":1095,"col":24},"end":{"line":1098,"col":9},"lines":"        ${item.notes ? `\n          <h3 style=\"margin: 20px 0 10px 0; color: #333;\">Notes</h3>\n          <p style=\"border: 1px solid #ddd; padding: 12px; background: #fafafa;\">${item.notes}</p>\n        ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"f3eaff48f08e3716533ccf7798473110a03eab72454103392433a5200fa28be3def8e2a50a27aa5ee640e49383a4abb915db40ba7adee62aaa9e78c461aa8f0c_0"},{"location":{"path":"client/src/pages/payroll.tsx","start":{"line":163,"col":32},"end":{"line":163,"col":47},"lines":"        window.location.href = data.connectUrl;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.browser.security.js-open-redirect-from-function","message":"The application accepts potentially user-controlled input `data` which can control the location of the current window context. This can lead two types of vulnerabilities open-redirection and Cross-Site-Scripting (XSS) with JavaScript URIs. It is recommended to validate user-controllable input before allowing it to control the redirection.","severity":"LOW","fingerprint":"d6fe5c0c7dd3001d4753ba566f57281fc77b91f898a64f3a829828514e9d9b2222f981c97450f19203b4687a0d3d25c74ebd57d5dbb7f0fa91f31ded535d0032_0"},{"location":{"path":"client/src/pages/pricing.tsx","start":{"line":75,"col":32},"end":{"line":75,"col":40},"lines":"        window.location.href = data.url;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.browser.security.js-open-redirect-from-function","message":"The application accepts potentially user-controlled input `data` which can control the location of the current window context. This can lead two types of vulnerabilities open-redirection and Cross-Site-Scripting (XSS) with JavaScript URIs. It is recommended to validate user-controllable input before allowing it to control the redirection.","severity":"LOW","fingerprint":"673afc2e05d42fb03c2f0e1dc8e327b53ce2f6fb2390910a7b551da467d4f57be3249a6302ba31cb1903fb94e7f57d7c52b95ca4ccb50edb97b6e1cae149f5e0_0"},{"location":{"path":"client/src/pages/pricing.tsx","start":{"line":94,"col":32},"end":{"line":94,"col":40},"lines":"        window.location.href = data.url;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.browser.security.js-open-redirect-from-function","message":"The application accepts potentially user-controlled input `data` which can control the location of the current window context. This can lead two types of vulnerabilities open-redirection and Cross-Site-Scripting (XSS) with JavaScript URIs. It is recommended to validate user-controllable input before allowing it to control the redirection.","severity":"LOW","fingerprint":"673afc2e05d42fb03c2f0e1dc8e327b53ce2f6fb2390910a7b551da467d4f57be3249a6302ba31cb1903fb94e7f57d7c52b95ca4ccb50edb97b6e1cae149f5e0_1"},{"location":{"path":"client/src/pages/reconciliation-hub.tsx","start":{"line":714,"col":27},"end":{"line":832,"col":5},"lines":"    const reportContent = `\n      <div style=\"font-family: Arial, sans-serif; padding: 40px; max-width: 800px;\">\n        <div style=\"text-align: center; margin-bottom: 40px;\">\n          <h1 style=\"color: #333; margin-bottom: 10px;\">Bank Reconciliation Report</h1>\n          <p style=\"color: #666; font-size: 14px;\">${currentOrganization?.name}</p>\n        </div>\n\n        <div style=\"border: 1px solid #e0e0e0; padding: 20px; margin-bottom: 30px; border-radius: 8px;\">\n          <h2 style=\"color: #333; font-size: 18px; margin-bottom: 15px;\">Reconciliation Details</h2>\n          <table style=\"width: 100%; border-collapse: collapse;\">\n            <tr>\n              <td style=\"padding: 8px 0; color: #666;\">Account Name:</td>\n              <td style=\"padding: 8px 0; font-weight: bold;\">${reconciliation.accountName}</td>\n            </tr>\n            <tr>\n              <td style=\"padding: 8px 0; color: #666;\">Statement Period:</td>\n              <td style=\"padding: 8px 0; font-weight: bold;\">\n                ${safeFormatDate(reconciliation.statementStartDate, 'MMM dd, yyyy')} - \n                ${safeFormatDate(reconciliation.statementEndDate, 'MMM dd, yyyy')}\n              </td>\n            </tr>\n            <tr>\n              <td style=\"padding: 8px 0; color: #666;\">Book Balance:</td>\n              <td style=\"padding: 8px 0; font-weight: bold;\">${formatCurrency(reconciliation.bookBalance)}</td>\n            </tr>\n            <tr>\n              <td style=\"padding: 8px 0; color: #666;\">Statement Balance:</td>\n              <td style=\"padding: 8px 0; font-weight: bold;\">${formatCurrency(reconciliation.statementBalance)}</td>\n            </tr>\n            <tr>\n              <td style=\"padding: 8px 0; color: #666;\">Difference:</td>\n              <td style=\"padding: 8px 0; font-weight: bold; color: ${difference > 0.01 ? '#dc2626' : '#16a34a'};\">\n                ${formatCurrency(difference)}\n              </td>\n            </tr>\n            <tr>\n              <td style=\"padding: 8px 0; color: #666;\">Status:</td>\n              <td style=\"padding: 8px 0; font-weight: bold; text-transform: capitalize;\">${reconciliation.status}</td>\n            </tr>\n          </table>\n        </div>\n\n        <div style=\"margin-bottom: 30px;\">\n          <h2 style=\"color: #333; font-size: 18px; margin-bottom: 15px;\">Summary</h2>\n          <table style=\"width: 100%; border-collapse: collapse; border: 1px solid #e0e0e0;\">\n            <thead>\n              <tr style=\"background-color: #f9fafb;\">\n                <th style=\"padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0;\">Category</th>\n                <th style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">Count</th>\n                <th style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">Amount</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">Matched Items</td>\n                <td style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">${existingMatches.length}</td>\n                <td style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">\n                  ${formatCurrency(existingMatches.reduce((sum, match) => {\n                    const txn = unreconciledTransactions.find(t => t.id === match.transactionId)\n                      || periodTransactions.find(t => t.id === match.transactionId);\n                    return sum + (txn ? parseFloat(txn.amount) : 0);\n                  }, 0))}\n                </td>\n              </tr>\n              <tr>\n                <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">Unmatched Transactions</td>\n                <td style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">${unmatchedTransactions.length}</td>\n                <td style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">\n                  ${formatCurrency(totalTransactionAmount)}\n                </td>\n              </tr>\n              <tr>\n                <td style=\"padding: 12px;\">Unmatched Statement Entries</td>\n                <td style=\"padding: 12px; text-align: right;\">${unmatchedStatements.length}</td>\n                <td style=\"padding: 12px; text-align: right;\">\n                  ${formatCurrency(totalStatementAmount)}\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        ${existingMatches.length > 0 ? `\n          <div style=\"margin-bottom: 30px;\">\n            <h2 style=\"color: #333; font-size: 18px; margin-bottom: 15px;\">Matched Items</h2>\n            <table style=\"width: 100%; border-collapse: collapse; border: 1px solid #e0e0e0;\">\n              <thead>\n                <tr style=\"background-color: #f9fafb;\">\n                  <th style=\"padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0;\">Date</th>\n                  <th style=\"padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0;\">Transaction</th>\n                  <th style=\"padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0;\">Statement Entry</th>\n                  <th style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">Amount</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${existingMatches.map(match => {\n                  const txn = unreconciledTransactions.find(t => t.id === match.transactionId)\n                    || periodTransactions.find(t => t.id === match.transactionId);\n                  const entry = statementEntries.find(e => e.id === match.statementEntryId);\n                  if (!txn || !entry) return '';\n                  return `\n                    <tr>\n                      <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">${safeFormatDate(txn.date, 'MMM dd, yyyy')}</td>\n                      <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">${txn.description}</td>\n                      <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">${entry.description}</td>\n                      <td style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">${formatCurrency(txn.amount)}</td>\n                    </tr>\n                  `;\n                }).join('')}\n              </tbody>\n            </table>\n          </div>\n        ` : ''}\n\n        <div style=\"margin-top: 40px; padding-top: 20px; border-top: 2px solid #e0e0e0; text-align: center; color: #666; font-size: 12px;\">\n          <p>Generated on ${format(new Date(), 'MMMM dd, yyyy \\'at\\' hh:mm a')}</p>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"400041048cb6e1775dd20e89a50ceb72ef79a537db4a0bf1bda908f84c50f5c56c7d786e469f19b13a2edcce425b4572a46696f2bebb104613c29ac619053ce9_0"},{"location":{"path":"client/src/pages/reconciliation-hub.tsx","start":{"line":814,"col":26},"end":{"line":821,"col":19},"lines":"                  return `\n                    <tr>\n                      <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">${safeFormatDate(txn.date, 'MMM dd, yyyy')}</td>\n                      <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">${txn.description}</td>\n                      <td style=\"padding: 12px; border-bottom: 1px solid #e0e0e0;\">${entry.description}</td>\n                      <td style=\"padding: 12px; text-align: right; border-bottom: 1px solid #e0e0e0;\">${formatCurrency(txn.amount)}</td>\n                    </tr>\n                  `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"5fcc42ff8199feb50c7dd8839f5ef079e263bd988e8ec34c11355baf95e526b771acc8517c52c628857e20c6a891b35cdbdac1de22b8485a913f479b3d369f6d_0"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":204,"col":9},"end":{"line":204,"col":154},"lines":"      ? `<img src=\"${currentOrganization.logoUrl}\" alt=\"Logo\" width=\"180\" style=\"display: block; max-width: 180px; height: auto; margin-bottom: 10px;\" />` "},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"1e6344e43b0319f703581f0783746ee04f6560e470f8f5251a85e0547599a39b2b162ad05d367e98af22aed1d2f871a8dfa871dfdd6b4e53d1e2f5713273f137_0"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":207,"col":12},"end":{"line":216,"col":5},"lines":"    return `\n      <div class=\"header\">\n        ${logoHtml}\n        <div class=\"header-text\">\n          <h1>${title}</h1>\n          <div class=\"org-name\">${currentOrganization.companyName || currentOrganization.name}</div>\n          <div class=\"date-range\">${dateInfo}</div>\n        </div>\n      </div>\n    `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"de8f24acb8285439d8b5e441724407fd6c4a1828f39929bb1b2ca990c9c6aa6f06066039c021c217dea861ae5da8e871aba4720260ae7408e5be7247fefb544d_0"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":221,"col":9},"end":{"line":221,"col":72},"lines":"      ? `<div class=\"footer\">${currentOrganization.invoiceFooter}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"eb3315f04e1bfc5474134c4721d37abc3598e78b290f42264f520c8c007a40d1f9dfe148052b7533a015284bd357486f2a29fb55b4e19d38fff9479dec1fe561_0"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":242,"col":57},"end":{"line":247,"col":15},"lines":"              ${profitLoss.incomeByCategory.map(item => `\n                <tr>\n                  <td>${item.categoryName || 'Uncategorized'}</td>\n                  <td class=\"amount\">$${parseFloat(item.amount).toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>\n                </tr>\n              `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6007d96b435686e9591c3e2636e285f1fc278a8681591b7388a53d03f90a0335312eed2f6193e3d05a7ad2e8cbca2f663b84135c3f9e3b0727eb7d6b7fc3dd57_0"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":261,"col":59},"end":{"line":266,"col":15},"lines":"              ${profitLoss.expensesByCategory.map(item => `\n                <tr>\n                  <td>${item.categoryName || 'Uncategorized'}</td>\n                  <td class=\"amount\">$${parseFloat(item.amount).toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>\n                </tr>\n              `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6007d96b435686e9591c3e2636e285f1fc278a8681591b7388a53d03f90a0335312eed2f6193e3d05a7ad2e8cbca2f663b84135c3f9e3b0727eb7d6b7fc3dd57_1"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":306,"col":59},"end":{"line":311,"col":15},"lines":"              ${balanceSheet.assetsByCategory.map(item => `\n                <tr>\n                  <td>${item.categoryName}</td>\n                  <td class=\"amount\">$${parseFloat(item.amount).toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>\n                </tr>\n              `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6007d96b435686e9591c3e2636e285f1fc278a8681591b7388a53d03f90a0335312eed2f6193e3d05a7ad2e8cbca2f663b84135c3f9e3b0727eb7d6b7fc3dd57_2"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":325,"col":64},"end":{"line":330,"col":15},"lines":"              ${balanceSheet.liabilitiesByCategory.map(item => `\n                <tr>\n                  <td>${item.categoryName}</td>\n                  <td class=\"amount\">$${parseFloat(item.amount).toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>\n                </tr>\n              `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6007d96b435686e9591c3e2636e285f1fc278a8681591b7388a53d03f90a0335312eed2f6193e3d05a7ad2e8cbca2f663b84135c3f9e3b0727eb7d6b7fc3dd57_3"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":344,"col":59},"end":{"line":349,"col":15},"lines":"              ${balanceSheet.equityByCategory.map(item => `\n                <tr>\n                  <td>${item.categoryName}</td>\n                  <td class=\"amount\">$${parseFloat(item.amount).toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>\n                </tr>\n              `).join('')}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6007d96b435686e9591c3e2636e285f1fc278a8681591b7388a53d03f90a0335312eed2f6193e3d05a7ad2e8cbca2f663b84135c3f9e3b0727eb7d6b7fc3dd57_4"},{"location":{"path":"client/src/pages/reports.tsx","start":{"line":398,"col":24},"end":{"line":406,"col":17},"lines":"                return `\n                  <tr>\n                    <td>${format(new Date(t.date + 'T12:00:00'), 'MM/dd/yyyy')}</td>\n                    <td>${t.description}</td>\n                    <td>${t.type}</td>\n                    <td>${category?.name || 'Uncategorized'}</td>\n                    <td class=\"amount\">$${parseFloat(t.amount).toLocaleString('en-US', { minimumFractionDigits: 2 })}</td>\n                  </tr>\n                `;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"da5bb99b79ea2a4464fc223e655765fa9a3597c1d1b39677cff3110dd7cbcd7e71b8917df744c8aa1db645ef9620ee29640a83dcb124536d1495e0fce35d148e_0"},{"location":{"path":"client/src/pages/surveys.tsx","start":{"line":493,"col":12},"end":{"line":493,"col":170},"lines":"    return `<iframe src=\"${getPublicUrl(publicId)}?embed=true\" width=\"100%\" height=\"600\" frameborder=\"0\" style=\"border: 1px solid #e5e7eb; border-radius: 8px;\"></iframe>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"853460575aa1a1ab1d46576c49461b974d36bcd6f9db03b0f4370f4bab6f449259a65395540c78747dd7c6e979696f9f2d2a5ba198020654388649cad24b666f_0"},{"location":{"path":"server/aiCategorization.ts","start":{"line":316,"col":23},"end":{"line":316,"col":93},"lines":"        console.error(`[AI Bulk Categorization] JSON parse error in chunk ${chunkIndex + 1}:`, parseError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"3a90cded8ac91e6103477b7a07e441c10904f2f98d4b58a04ddbc19b6280009e443c0ca8b81a8f82d8a1382894e78391068a7070c02cbddde9753ac248f3aa30_0"},{"location":{"path":"server/email.ts","start":{"line":93,"col":7},"end":{"line":93,"col":165},"lines":"    ? `<div style=\"text-align: center; margin-bottom: 20px;\"><img src=\"${branding.logoUrl}\" alt=\"Organization Logo\" style=\"max-width: 150px; height: auto;\" /></div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"98ddd01ed15c0ed19430ee1796d02ef9e35722cfcc18b21c17fd1b24fca95e7b072136948915a97e950fec08338a3a327c8d953f538f1246fee290cc7f83a40a_0"},{"location":{"path":"server/email.ts","start":{"line":96,"col":7},"end":{"line":96,"col":186},"lines":"    ? `<div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px; margin-top: 20px; text-align: center; color: #666; font-size: 12px; white-space: pre-line;\">${branding.footer}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"bd75f094610692a4f6f0dd570c738c0a3f4ab021ab8b65c9231c189107b1ef2adbf1bf6379e1c0a388349c8956a024799afc319ffc0d3d09f46752b84bbb2b37_0"},{"location":{"path":"server/email.ts","start":{"line":262,"col":27},"end":{"line":267,"col":13},"lines":"            ${userEmail ? `\n            <div style=\"margin-bottom: 15px;\">\n              <p style=\"color: #666; margin: 0 0 5px 0; font-size: 14px;\">User</p>\n              <p style=\"color: #1a1a1a; margin: 0; font-size: 16px; font-weight: 500;\">${userEmail}</p>\n            </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"3b53871ba9052753f6ffa24cc851c0808b0a653d85977149ae19e8e4b24381dd95ff9ab3f7c3afd7bcc9ba4b13f7e757700a0b82abd30f51947ac92e58518011_0"},{"location":{"path":"server/email.ts","start":{"line":269,"col":27},"end":{"line":274,"col":13},"lines":"            ${ipAddress ? `\n            <div style=\"margin-bottom: 15px;\">\n              <p style=\"color: #666; margin: 0 0 5px 0; font-size: 14px;\">IP Address</p>\n              <p style=\"color: #1a1a1a; margin: 0; font-size: 16px; font-weight: 500;\">${ipAddress}</p>\n            </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"c32fd281b2a7bca9b786afffa92e6e0012aa1282ec733cb65c26930ee8b622b07a349c297b39b9162497c93f2f08864908fb20971bd322261740739cd9887343_0"},{"location":{"path":"server/email.ts","start":{"line":276,"col":25},"end":{"line":281,"col":13},"lines":"            ${details ? `\n            <div style=\"margin-bottom: 15px;\">\n              <p style=\"color: #666; margin: 0 0 5px 0; font-size: 14px;\">Additional Details</p>\n              <pre style=\"background-color: #f3f4f6; padding: 10px; border-radius: 4px; font-size: 12px; overflow-x: auto;\">${JSON.stringify(details, null, 2)}</pre>\n            </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"6e1909cef9b9e46c24da38b02a7e49fd4a3c7003418c6951ef344520df6f34a7da627b9c6882b886ca90610fc03340e8cfab8264b0df1969f8794d0b4b0c8aad_0"},{"location":{"path":"server/email.ts","start":{"line":373,"col":7},"end":{"line":373,"col":172},"lines":"    ? `<div style=\"margin-bottom: 15px;\"><img src=\"${branding.logoUrl}\" alt=\"${organizationName}\" style=\"max-width: 120px; max-height: 40px; object-fit: contain;\" /></div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"027b7b84facd872c86586bdffd4981d0ac1e17b3fa1b49aa457454c8b44832b66a0e4d432b29d3fcb74463c273e4021906dc24475139ca108b1eedede7c135ec_0"},{"location":{"path":"server/email.ts","start":{"line":376,"col":7},"end":{"line":376,"col":186},"lines":"    ? `<div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px; margin-top: 20px; text-align: center; color: #666; font-size: 12px; white-space: pre-line;\">${branding.footer}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"bd75f094610692a4f6f0dd570c738c0a3f4ab021ab8b65c9231c189107b1ef2adbf1bf6379e1c0a388349c8956a024799afc319ffc0d3d09f46752b84bbb2b37_1"},{"location":{"path":"server/email.ts","start":{"line":380,"col":7},"end":{"line":383,"col":14},"lines":"    ? `<div style=\"text-align: center; margin: 30px 0; padding: 20px; background-color: #f0fdf4; border-radius: 8px; border: 1px solid #bbf7d0;\">\n         <p style=\"color: #166534; margin: 0 0 15px 0; font-size: 16px; font-weight: 600;\">Pay this invoice securely online</p>\n         <a href=\"${paymentUrl}\" style=\"display: inline-block; background-color: #16a34a; color: #ffffff; text-decoration: none; padding: 14px 40px; border-radius: 6px; font-weight: 600; font-size: 16px;\">Pay Now - $${amount.toFixed(2)}</a>\n       </div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"eecedd2374c4e6c122fefdf003facc1d3dc425523cb89f14184c86959ea0d68150eae0cbcdf9e7d8c1fa1eb9a536978b94e9216fc9631cbf066f2612762c6f5a_0"},{"location":{"path":"server/email.ts","start":{"line":386,"col":39},"end":{"line":393,"col":3},"lines":"  const itemsHtml = items.map(item => `\n    <tr>\n      <td style=\"padding: 12px; border-bottom: 1px solid #e5e7eb; color: #1a1a1a;\">${item.description}</td>\n      <td style=\"padding: 12px; border-bottom: 1px solid #e5e7eb; text-align: center; color: #1a1a1a;\">${item.quantity}</td>\n      <td style=\"padding: 12px; border-bottom: 1px solid #e5e7eb; text-align: right; color: #1a1a1a;\">$${item.unitPrice.toFixed(2)}</td>\n      <td style=\"padding: 12px; border-bottom: 1px solid #e5e7eb; text-align: right; color: #1a1a1a; font-weight: 500;\">$${item.total.toFixed(2)}</td>\n    </tr>\n  `).join('');"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"798fdbcf904d4855dd58691ba433e68d50669b3fde428cb8acd7df9287cc0b620e3d0342f05fcfd7f7c75b984ec46d029352cdeecb05f458c97773d170fa00c2_0"},{"location":{"path":"server/email.ts","start":{"line":424,"col":39},"end":{"line":424,"col":124},"lines":"                ${organizationEmail ? `<p style=\"color: #666; margin: 5px 0 0 0; font-size: 14px;\">${organizationEmail}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"0dba32d972e9c5abc9158998142b4a448f1d0b31ddb3604b7376048a0019d36729db331ebe1a38ca1035efdb2ad698a40bb874acc4911f2aebfc175ef07cedcb_0"},{"location":{"path":"server/email.ts","start":{"line":425,"col":39},"end":{"line":425,"col":124},"lines":"                ${organizationPhone ? `<p style=\"color: #666; margin: 5px 0 0 0; font-size: 14px;\">${organizationPhone}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"e3dedebe82212dfef83a242b6e4197de7fd27499de897271e626feea9b6cb3a9d11aa87f068c0d18dd4e82733d140b1d637222f0e6c1e4dfe526ed9d771c0b43_0"},{"location":{"path":"server/email.ts","start":{"line":426,"col":41},"end":{"line":426,"col":151},"lines":"                ${organizationAddress ? `<p style=\"color: #666; margin: 5px 0 0 0; font-size: 14px; white-space: pre-line;\">${organizationAddress}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"99d6851f5a7cb562875ae4a05de6c9ae2f82d320a8457e49d3614b4f766d927f967f9c469e0ce2e5daab6a8f3f08237fd6d993f9f042288bb37d6370e285dad1_0"},{"location":{"path":"server/email.ts","start":{"line":472,"col":23},"end":{"line":477,"col":13},"lines":"            ${notes ? `\n            <div style=\"background-color: #f0f9ff; border-left: 4px solid ${accentColor}; padding: 15px; border-radius: 4px; margin-top: 20px;\">\n              <h3 style=\"color: #1a1a1a; margin: 0 0 10px 0; font-size: 14px; font-weight: 600;\">Notes</h3>\n              <p style=\"color: #666; margin: 0; font-size: 14px; white-space: pre-line;\">${notes}</p>\n            </div>\n            ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"9de8db237a2ce9a1c55db2a06c96434cc62e884af354e686950bc7ad29d5673db6772ae27c643b191377abd6c81d0f23afd57c17809f25fdb1d1d84d56ec8434_0"},{"location":{"path":"server/email.ts","start":{"line":671,"col":11},"end":{"line":726,"col":5},"lines":"    html: `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset=\"utf-8\">\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n          <title>Payment Confirmation</title>\n        </head>\n        <body style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;\">\n          <div style=\"background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 8px; padding: 30px; margin-bottom: 20px; color: white; text-align: center;\">\n            <div style=\"font-size: 48px; margin-bottom: 10px;\">&#10003;</div>\n            <h1 style=\"color: white; margin: 0 0 10px 0; font-size: 24px;\">Payment Received!</h1>\n            <p style=\"color: rgba(255,255,255,0.95); margin: 0; font-size: 16px;\">Thank you for your payment</p>\n          </div>\n          \n          <div style=\"background-color: #ffffff; border: 1px solid #e5e7eb; border-radius: 8px; padding: 25px; margin-bottom: 20px;\">\n            <p style=\"color: #1a1a1a; margin: 0 0 20px 0; font-size: 16px;\">Hi ${clientName},</p>\n            \n            <p style=\"color: #666; margin: 0 0 20px 0; font-size: 15px;\">\n              We've received your payment. Here are the details:\n            </p>\n            \n            <div style=\"background-color: #f9fafb; border-radius: 8px; padding: 20px; margin-bottom: 20px;\">\n              <table style=\"width: 100%; border-collapse: collapse;\">\n                <tr>\n                  <td style=\"padding: 8px 0; color: #666; font-size: 14px;\">Invoice Number:</td>\n                  <td style=\"padding: 8px 0; color: #1a1a1a; font-size: 14px; text-align: right; font-weight: 600;\">${invoiceNumber}</td>\n                </tr>\n                <tr>\n                  <td style=\"padding: 8px 0; color: #666; font-size: 14px;\">Amount Paid:</td>\n                  <td style=\"padding: 8px 0; color: #10b981; font-size: 18px; text-align: right; font-weight: 700;\">$${amount}</td>\n                </tr>\n                <tr>\n                  <td style=\"padding: 8px 0; color: #666; font-size: 14px;\">Payment Date:</td>\n                  <td style=\"padding: 8px 0; color: #1a1a1a; font-size: 14px; text-align: right;\">${formattedDate}</td>\n                </tr>\n                <tr>\n                  <td style=\"padding: 8px 0; color: #666; font-size: 14px;\">From:</td>\n                  <td style=\"padding: 8px 0; color: #1a1a1a; font-size: 14px; text-align: right;\">${organizationName}</td>\n                </tr>\n              </table>\n            </div>\n            \n            <p style=\"color: #666; margin: 0; font-size: 14px;\">\n              This email serves as your payment confirmation. Please keep it for your records.\n            </p>\n          </div>\n          \n          <div style=\"text-align: center; color: #666; font-size: 12px;\">\n            <p style=\"margin: 0;\">\n              Thank you for your business!\n            </p>\n          </div>\n        </body>\n      </html>\n    `,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"324ce159cddc0cf6ff2bcfe310b34e4e95a921ac9f4238ac38ebe6597b5c3aafee51697f75c68db6a3a426863e03e1c07ca1105420e17b94750593e2149d98f3_0"},{"location":{"path":"server/email.ts","start":{"line":781,"col":7},"end":{"line":781,"col":219},"lines":"    ? `<div style=\"text-align: center; margin-bottom: 20px;\"><img src=\"${branding.logoUrl}\" alt=\"${organizationName}\" style=\"max-width: 180px; max-height: 60px; width: auto; height: auto; object-fit: contain;\" /></div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"98ddd01ed15c0ed19430ee1796d02ef9e35722cfcc18b21c17fd1b24fca95e7b072136948915a97e950fec08338a3a327c8d953f538f1246fee290cc7f83a40a_1"},{"location":{"path":"server/email.ts","start":{"line":837,"col":32},"end":{"line":837,"col":211},"lines":"          ${branding?.footer ? `<div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px; margin-top: 20px; text-align: center; color: #666; font-size: 12px; white-space: pre-line;\">${branding.footer}</div>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"bd75f094610692a4f6f0dd570c738c0a3f4ab021ab8b65c9231c189107b1ef2adbf1bf6379e1c0a388349c8956a024799afc319ffc0d3d09f46752b84bbb2b37_2"},{"location":{"path":"server/email.ts","start":{"line":902,"col":7},"end":{"line":902,"col":167},"lines":"    ? `<div style=\"text-align: center; margin-bottom: 20px;\"><img src=\"${branding.logoUrl}\" alt=\"${organizationName}\" style=\"max-width: 150px; height: auto;\" /></div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"98ddd01ed15c0ed19430ee1796d02ef9e35722cfcc18b21c17fd1b24fca95e7b072136948915a97e950fec08338a3a327c8d953f538f1246fee290cc7f83a40a_2"},{"location":{"path":"server/email.ts","start":{"line":949,"col":39},"end":{"line":949,"col":117},"lines":"  const categoryLine = categoryName ? `<p style=\"margin: 0 0 10px 0;\"><strong>Category:</strong> ${categoryName}</p>` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"5a47981da38f285424af1d31e54c2ce9904532cb63a3002dcd70c79fb580943ca9f652eda715a54240e08a410e5b249054c659f60423a32ff92c97ffb36e8a73_0"},{"location":{"path":"server/email.ts","start":{"line":950,"col":50},"end":{"line":950,"col":140},"lines":"  const daysLine = daysRemaining !== undefined ? `<p style=\"margin: 0 0 10px 0;\"><strong>Days Remaining:</strong> ${daysRemaining} days</p>` : '';"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"29f389c909ad25825f710a5a36fae72a5cd41e06c82e2e2a7cba40144aa24000b5026b7c7384263f29fdac283e6437c3493969e5bad6567ad0931be944de4c53_0"},{"location":{"path":"server/email.ts","start":{"line":952,"col":7},"end":{"line":952,"col":126},"lines":"    ? `<p style=\"margin: 0 0 10px 0; color: #dc2626;\"><strong>Projected Overage:</strong> $${projectedOverage.toFixed(2)}</p>` "},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"ebea28c56d5589842b4cdd41f0bb6c6b7bdbe3b641660dd5a3c4f30aeb883becef4a570df63b1fc7527881d08d65cbb71b5297a18834ac951328ce0101f48421_0"},{"location":{"path":"server/email.ts","start":{"line":1081,"col":7},"end":{"line":1081,"col":165},"lines":"    ? `<div style=\"text-align: center; margin-bottom: 20px;\"><img src=\"${branding.logoUrl}\" alt=\"Organization Logo\" style=\"max-width: 150px; height: auto;\" /></div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"98ddd01ed15c0ed19430ee1796d02ef9e35722cfcc18b21c17fd1b24fca95e7b072136948915a97e950fec08338a3a327c8d953f538f1246fee290cc7f83a40a_3"},{"location":{"path":"server/email.ts","start":{"line":1084,"col":7},"end":{"line":1084,"col":186},"lines":"    ? `<div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px; margin-top: 20px; text-align: center; color: #666; font-size: 12px; white-space: pre-line;\">${branding.footer}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"bd75f094610692a4f6f0dd570c738c0a3f4ab021ab8b65c9231c189107b1ef2adbf1bf6379e1c0a388349c8956a024799afc319ffc0d3d09f46752b84bbb2b37_3"},{"location":{"path":"server/email.ts","start":{"line":1090,"col":7},"end":{"line":1090,"col":108},"lines":"    ? `<p style=\"color: #4a5568; font-size: 14px; margin: 15px 0; line-height: 1.6;\">${formDescription}</p>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"43a67ac4e4fa70549e84a3f1de3df03c5faaff310adc75e816b6ce9823f716548ba3c080621ca1dc1ffa90b6790f3505e654fbfc299c262a2670e5ab62822c4d_0"},{"location":{"path":"server/email.ts","start":{"line":1093,"col":7},"end":{"line":1095,"col":14},"lines":"    ? `<div style=\"background-color: #f8fafc; border-left: 4px solid ${primaryColor}; padding: 15px; margin: 20px 0; border-radius: 0 8px 8px 0;\">\n         <p style=\"color: #4a5568; font-size: 14px; margin: 0; font-style: italic;\">\"${personalMessage}\"</p>\n       </div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"d99ebe32e3d69baf06c20215b2085b43e535f6c3389bd115c3a3ca3fe910ae44e20f01d5e7637d4bfa90abb15b19c2aa0591be494e7aceb9188e376ce4eb92f6_0"},{"location":{"path":"server/email.ts","start":{"line":1102,"col":11},"end":{"line":1188,"col":5},"lines":"    html: `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset=\"utf-8\">\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n          <title>${typeLabel} from ${organizationName}</title>\n        </head>\n        <body style=\"font-family: ${fontFamily}; line-height: 1.6; color: #333; margin: 0; padding: 0; background-color: #f5f5f5;\">\n          <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #f5f5f5; padding: 40px 20px;\">\n            <tr>\n              <td align=\"center\">\n                <table width=\"600\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width: 600px; background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\">\n                  <!-- Header -->\n                  <tr>\n                    <td style=\"background-color: ${primaryColor}; padding: 32px 40px; text-align: center;\">\n                      <h2 style=\"color: white; margin: 0; font-size: 22px; font-weight: 600;\">${organizationName}</h2>\n                    </td>\n                  </tr>\n                  \n                  <!-- Body -->\n                  <tr>\n                    <td style=\"padding: 40px;\">\n                      <p style=\"color: #374151; font-size: 16px; margin: 0 0 24px 0;\">Dear ${recipientName},</p>\n                      \n                      <p style=\"color: #374151; font-size: 16px; margin: 0 0 24px 0;\">\n                        We invite you to complete the following ${typeLabel.toLowerCase()}:\n                      </p>\n                      \n                      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb; margin-bottom: 24px;\">\n                        <tr>\n                          <td style=\"padding: 24px;\">\n                            <h3 style=\"color: #111827; margin: 0 0 8px 0; font-size: 18px; font-weight: 600;\">${formTitle}</h3>\n                            ${formDescription ? `<p style=\"color: #6b7280; font-size: 14px; margin: 0; line-height: 1.5;\">${formDescription}</p>` : ''}\n                          </td>\n                        </tr>\n                      </table>\n                      \n                      ${personalMessage ? `\n                      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin-bottom: 24px;\">\n                        <tr>\n                          <td style=\"border-left: 3px solid ${primaryColor}; padding-left: 16px;\">\n                            <p style=\"color: #4b5563; font-size: 14px; margin: 0; font-style: italic;\">\"${personalMessage}\"</p>\n                          </td>\n                        </tr>\n                      </table>\n                      ` : ''}\n                      \n                      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                        <tr>\n                          <td align=\"center\" style=\"padding: 16px 0 32px 0;\">\n                            <a href=\"${formUrl}\" style=\"display: inline-block; background-color: ${primaryColor}; color: white; text-decoration: none; padding: 14px 40px; border-radius: 6px; font-weight: 600; font-size: 16px;\">\n                              ${actionText}\n                            </a>\n                          </td>\n                        </tr>\n                      </table>\n                      \n                      <p style=\"color: #9ca3af; font-size: 13px; margin: 0; text-align: center;\">\n                        Or copy this link: <a href=\"${formUrl}\" style=\"color: ${primaryColor}; word-break: break-all;\">${formUrl}</a>\n                      </p>\n                    </td>\n                  </tr>\n                  \n                  ${branding?.footer ? `\n                  <tr>\n                    <td style=\"border-top: 1px solid #e5e7eb; padding: 24px 40px;\">\n                      <p style=\"color: #6b7280; font-size: 13px; margin: 0; text-align: center; white-space: pre-line;\">${branding.footer}</p>\n                    </td>\n                  </tr>\n                  ` : ''}\n                  \n                  <!-- Footer -->\n                  <tr>\n                    <td style=\"background-color: #f9fafb; padding: 20px 40px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                      <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                        Powered by <a href=\"https://complybook.net\" style=\"color: ${primaryColor}; text-decoration: none;\">ComplyBook</a>\n                      </p>\n                    </td>\n                  </tr>\n                </table>\n              </td>\n            </tr>\n          </table>\n        </body>\n      </html>\n    `,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"edf3346aab0a40b2aef60fbcc8a457368590f7ddafbd6f556227b81a7242bf54215dcc324fc0b3d4c04ee52931d21820360a2eb5133f6c2da78e52ec40314852_0"},{"location":{"path":"server/email.ts","start":{"line":1135,"col":49},"end":{"line":1135,"col":145},"lines":"                            ${formDescription ? `<p style=\"color: #6b7280; font-size: 14px; margin: 0; line-height: 1.5;\">${formDescription}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"1c22c82e466e69b808a930fb83f2f5e9dbfeaddc2d558c559acdfb94767f2ccb562d54efad1d92926f857db88b93b7dcd32fbe5e25e4084fc64cf2dee4b8743c_0"},{"location":{"path":"server/email.ts","start":{"line":1140,"col":43},"end":{"line":1148,"col":23},"lines":"                      ${personalMessage ? `\n                      <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"margin-bottom: 24px;\">\n                        <tr>\n                          <td style=\"border-left: 3px solid ${primaryColor}; padding-left: 16px;\">\n                            <p style=\"color: #4b5563; font-size: 14px; margin: 0; font-style: italic;\">\"${personalMessage}\"</p>\n                          </td>\n                        </tr>\n                      </table>\n                      ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"f6ca5071be9c45a215161275db39ab8c4b2e618a5c8732241d824b3cb2d5a49292583ed181438c9c35ca6b24c2ca2ef3376a7c6cb02e61850e9865fa960ab018_0"},{"location":{"path":"server/email.ts","start":{"line":1166,"col":40},"end":{"line":1172,"col":19},"lines":"                  ${branding?.footer ? `\n                  <tr>\n                    <td style=\"border-top: 1px solid #e5e7eb; padding: 24px 40px;\">\n                      <p style=\"color: #6b7280; font-size: 13px; margin: 0; text-align: center; white-space: pre-line;\">${branding.footer}</p>\n                    </td>\n                  </tr>\n                  ` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"d537e8832e19f4cac081c9dd6fe154d4649e1378b3105548e31f5d07c7fae5166352340bcb2c6509702a9b6763c26877fe1a2eedd22b5a4dc06edb7fda4e4da1_0"},{"location":{"path":"server/email.ts","start":{"line":1280,"col":7},"end":{"line":1280,"col":128},"lines":"    ? `<img src=\"${branding.logoUrl}\" alt=\"${employerName}\" style=\"max-width: 150px; max-height: 50px; object-fit: contain;\" />`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"16b40705ca313728e5a0b5a733049058b1aa4bf096ad855167ecbe0e5d480d6af85edc695af1ca4742aa0f187d2d14edd7a33b6acb11371922a23bcdeb17bd7d_0"},{"location":{"path":"server/email.ts","start":{"line":1283,"col":7},"end":{"line":1283,"col":163},"lines":"    ? `<div style=\"text-align: center; color: #666; font-size: 11px; margin-top: 20px; padding-top: 15px; border-top: 1px solid #e5e7eb;\">${branding.footer}</div>`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"9acfc252905f8a5905a50bb74d211d8a3b9ce5028cbd0765beae4771f76b5ebcc507400b640697ac9bab1825c57f352aaa6b7d2ffe45a7fc67896cba810af1f3_0"},{"location":{"path":"server/email.ts","start":{"line":1289,"col":22},"end":{"line":1295,"col":10},"lines":"  let earningsHtml = `\n    <tr>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb;\">Regular</td>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb; text-align: right;\">${isHourly ? `$${formatMoney(hourlyRate || '0')}` : '-'}</td>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb; text-align: right;\">${isHourly ? (regularHours || '0.00') : '-'}</td>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb; text-align: right; font-weight: 500;\">$${formatMoney(regularPay)}</td>\n    </tr>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"b4c9985e144c2a673e505aa9d52b41a012cda2924292a7fe0c8712e6aeed89fb9fe46a13818110b7edeb1abb9dc8755dd447ae0e5ec2724a6c2318a2571b65df_0"},{"location":{"path":"server/email.ts","start":{"line":1298,"col":21},"end":{"line":1304,"col":10},"lines":"    earningsHtml += `\n    <tr>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb;\">Overtime</td>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb; text-align: right;\">-</td>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb; text-align: right;\">${overtimeHours || '-'}</td>\n      <td style=\"padding: 8px 10px; border-bottom: 1px solid #e5e7eb; text-align: right; font-weight: 500;\">$${formatMoney(overtimePay)}</td>\n    </tr>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"8e3bd240cecb1d2c76876a4dc51e9724bd7480a079e35bc4160258d62c3b3270752e81844401e2ddaed33979e87e5849d2c45ef6145c73324d26c14f8ca68ddc_0"},{"location":{"path":"server/email.ts","start":{"line":1318,"col":53},"end":{"line":1323,"col":3},"lines":"  let deductionsHtml = statutoryDeductions.map(d => `\n    <tr>\n      <td style=\"padding: 6px 10px; border-bottom: 1px solid #f3f4f6; font-size: 13px;\">${d.name}</td>\n      <td style=\"padding: 6px 10px; border-bottom: 1px solid #f3f4f6; text-align: right; font-size: 13px;\">$${formatMoney(d.amount)}</td>\n    </tr>\n  `).join('');"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"37bc822715b2a6520edc7ae006972f1b1c67c2a15b23002773b77bf35b96b701265ac456134800a3c706937735e4c0cb5f93abe3323ca347819dcefe66adcbe5_0"},{"location":{"path":"server/email.ts","start":{"line":1326,"col":23},"end":{"line":1330,"col":10},"lines":"    deductionsHtml += `\n    <tr>\n      <td style=\"padding: 6px 10px; border-bottom: 1px solid #f3f4f6; font-size: 13px;\">${d.name}</td>\n      <td style=\"padding: 6px 10px; border-bottom: 1px solid #f3f4f6; text-align: right; font-size: 13px;\">$${formatMoney(d.amount)}</td>\n    </tr>`;"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"ff10bd334ee5ee930dc7ae6626ecdb913accda8462d75dd1553f2696df41519bb3634b5ba13fcb46c5197bfb0cefc2f2efaa7e99efdfc27959d2ff1b2261d79a_0"},{"location":{"path":"server/email.ts","start":{"line":1351,"col":31},"end":{"line":1351,"col":116},"lines":"                ${logoHtml || `<h2 style=\"margin: 0; color: ${primaryColor}; font-size: 18px;\">${employerName}</h2>`}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"a9c86d786f66de6121350b8e14e9d70ae0fd69f1cccdb2e16b874664f875c7ae18a208e0170359df0c8f89bf3350fe3675623ea21b561d1fd919a15ed3b8a00c_0"},{"location":{"path":"server/email.ts","start":{"line":1352,"col":37},"end":{"line":1352,"col":143},"lines":"                ${employerAddress ? `<p style=\"margin: 5px 0 0 0; font-size: 12px; color: #666; white-space: pre-line;\">${employerAddress}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"f9f7f41ac13908870e4f37f9bb83c7237d8411db4688245f4c09ee7c9978850d75ac910e25439e3081414278c10ac4cf31f1f859b6de5bc13a2cde3416da42c9_0"},{"location":{"path":"server/email.ts","start":{"line":1353,"col":33},"end":{"line":1353,"col":117},"lines":"                ${employerEin ? `<p style=\"margin: 3px 0 0 0; font-size: 11px; color: #888;\">EIN: ${employerEin}</p>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"f421fac1fe80b0bbda879e965b32c710ad271843e6e1456b4cfb647efc5fb2f92cf9a0c9058fdd5d3599ecd5a41725ae48ed749201a81fc34a357cfd798c7f38_0"},{"location":{"path":"server/email.ts","start":{"line":1374,"col":41},"end":{"line":1374,"col":139},"lines":"                    ${employeeAddress ? `<br/><span style=\"color: #666; font-size: 11px; white-space: pre-line;\">${employeeAddress}</span>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"00a0bd04a173a7d9f24a405681fd238f6590b8273c9e6e0663b55b98895b72ba52fa44db3e595d6e17e908cc0c38c2245a8735d5a895cf99b68c2b0f341cd7a2_0"},{"location":{"path":"server/email.ts","start":{"line":1375,"col":37},"end":{"line":1375,"col":120},"lines":"                    ${ssnLastFour ? `<br/><span style=\"color: #888; font-size: 11px;\">SSN: XXX-XX-${ssnLastFour}</span>` : ''}"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"9d8a12a40bc3bca02dc7e4b31e4c83833b5e0faf1500116a6d1e443c1d0810415d6ab170514fbf7acd4c4bf06ea7442010bc1595fe428c9656011f56b3ab9fae_0"},{"location":{"path":"server/email.ts","start":{"line":1520,"col":11},"end":{"line":1546,"col":5},"lines":"    html: `\n      <!DOCTYPE html>\n      <html>\n        <head><meta charset=\"utf-8\"></head>\n        <body style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f8f9fa;\">\n          <div style=\"background: #ffffff; border-radius: 8px; padding: 30px; border: 1px solid #e9ecef;\">\n            <h2 style=\"color: #1a365d; margin-top: 0;\">New User Signup</h2>\n            <p style=\"color: #495057;\">A new user has signed up for ComplyBook:</p>\n            <table style=\"width: 100%; border-collapse: collapse; margin: 20px 0;\">\n              <tr>\n                <td style=\"padding: 8px 12px; border-bottom: 1px solid #e9ecef; color: #6c757d; font-weight: 600;\">Name</td>\n                <td style=\"padding: 8px 12px; border-bottom: 1px solid #e9ecef; color: #212529;\">${userName}</td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 12px; border-bottom: 1px solid #e9ecef; color: #6c757d; font-weight: 600;\">Email</td>\n                <td style=\"padding: 8px 12px; border-bottom: 1px solid #e9ecef; color: #212529;\">${userEmail}</td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 12px; border-bottom: 1px solid #e9ecef; color: #6c757d; font-weight: 600;\">Signed Up</td>\n                <td style=\"padding: 8px 12px; border-bottom: 1px solid #e9ecef; color: #212529;\">${signupTime}</td>\n              </tr>\n            </table>\n            <p style=\"color: #6c757d; font-size: 12px; margin-bottom: 0;\">This is an automated notification from ComplyBook.</p>\n          </div>\n        </body>\n      </html>\n    `,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.html-in-template-string","message":"This template literal looks like HTML and has interpolated variables. These variables are not HTML-encoded by default. If the variables contain HTML tags, these may be interpreted by the browser, resulting in cross-site scripting (XSS).","severity":"MEDIUM","fingerprint":"04fa3c934098fb0e07ec89c7cf69950dc9f89cc91e67d1f4731cb4f323e6c64d1d296107fd32492dcd674832f67d6b79b45c568f60701903a57eef0357e291e6_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":21,"col":24},"end":{"line":21,"col":31},"lines":"    if (!fs.existsSync(dirPath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dirPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"c1e8bccbea2e2289f35bbe35e3d533d508bd7be8a1289598bca1c803af90289c6f7e59795bf11f47af782c995d6609204c1f000d35af74f565c2a6d6685cb9b0_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":22,"col":20},"end":{"line":22,"col":27},"lines":"      fs.mkdirSync(dirPath, { recursive: true });"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `dirPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"c1e8bccbea2e2289f35bbe35e3d533d508bd7be8a1289598bca1c803af90289c6f7e59795bf11f47af782c995d6609204c1f000d35af74f565c2a6d6685cb9b0_1"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":27,"col":46},"end":{"line":27,"col":67},"lines":"    const orgPath = path.join(this.basePath, `org-${organizationId}`);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"667869a867ce16d5db617f0e815138650a5d655ac09a55ce8d5fe66f7ef64b503c969ce733253fe047870a0351cdb0b9800b21abb80e7b2774c8a4e2b9621739_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":34,"col":7},"end":{"line":34,"col":47},"lines":"      this.getOrganizationPath(organizationId),"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"9ba60eaefde9ee95a2bf242741ebcc2e6347b7fe5444f8d7a82edee825467f2007d91ef99a3268ea38b17b36c390e35eb5f92ebdf512176cc07013a7c6991e5f_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":35,"col":7},"end":{"line":35,"col":17},"lines":"      entityType,"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"2b17053633965caf36bdb81dcb819f16962f24a3d2694783e1c17856fda6644ef30b05d46d8205473299d85e07a406be534d4d7fef49a0af39c3388929fdef17_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":36,"col":7},"end":{"line":36,"col":18},"lines":"      `${entityId}`"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"f35f130bbc97e9424680a4989d71b3ad099544672320ea7df28c51aef5a4b33033bebb1833bb51a217aa72ef8fcc230c20bbc971925cac0a6643556f80aaccea_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":46,"col":22},"end":{"line":46,"col":43},"lines":"    return path.join(`org-${organizationId}`, entityType, `${entityId}`, finalFileName);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"667869a867ce16d5db617f0e815138650a5d655ac09a55ce8d5fe66f7ef64b503c969ce733253fe047870a0351cdb0b9800b21abb80e7b2774c8a4e2b9621739_1"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":46,"col":47},"end":{"line":46,"col":57},"lines":"    return path.join(`org-${organizationId}`, entityType, `${entityId}`, finalFileName);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"2b17053633965caf36bdb81dcb819f16962f24a3d2694783e1c17856fda6644ef30b05d46d8205473299d85e07a406be534d4d7fef49a0af39c3388929fdef17_1"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":46,"col":59},"end":{"line":46,"col":70},"lines":"    return path.join(`org-${organizationId}`, entityType, `${entityId}`, finalFileName);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"f35f130bbc97e9424680a4989d71b3ad099544672320ea7df28c51aef5a4b33033bebb1833bb51a217aa72ef8fcc230c20bbc971925cac0a6643556f80aaccea_1"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":57,"col":47},"end":{"line":57,"col":57},"lines":"    const fullPath = path.join(this.basePath, objectPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"ec2e4ff58be4c171833dd451888005dc74a20b62352251f3598f02c83a95c154bd78eab5b9ceff224b65f7d16d3421344848be5bafba801a562fa27ad14e94b8_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":62,"col":33},"end":{"line":62,"col":41},"lines":"    await fs.promises.writeFile(fullPath, fileBuffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `organizationId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"048a7826e9e753a97e193f0a55a405261cd3e20e8bece654fd447f92382c5878b7c24a61e4c0a56a49589b1889c90c5fa60214d391b033a8caee0335d3ad27b7_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":62,"col":33},"end":{"line":62,"col":41},"lines":"    await fs.promises.writeFile(fullPath, fileBuffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `entityType` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"4ad74b09f98476b82f143efb06f20cfac86866d8960e5aeba1e1305dc40605d4477021c7b4e4c2f04df1891d55cfc4264ea04a9e8448c2ffa32ff1e234df7911_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":62,"col":33},"end":{"line":62,"col":41},"lines":"    await fs.promises.writeFile(fullPath, fileBuffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `entityId` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"61276923d9e5e38425876758f2dbfef101c6f63a1a54a7714cc882b76f6d60b0ae310e5713b85a4f44ec70faed63bf5c63d96b637b18cb3f002817add7f5f55d_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":62,"col":33},"end":{"line":62,"col":41},"lines":"    await fs.promises.writeFile(fullPath, fileBuffer);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `fileName` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"fb830ce4e7275b36343be02710b75c3cdae73b1c75390ddc848ce7fdb3830d3f41eec40d4ddb9b27e9723f3c072f01625c1e87fbcfc06abba1cc31f55eaf6d8a_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":68,"col":47},"end":{"line":68,"col":57},"lines":"    const fullPath = path.join(this.basePath, objectPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"213f9f3f0ad1812e6be9d713434ee32a4d8abf32b9caa82422491e215442dd06dd2f23bcda9e8266b28720332fbb242c30d6892a00efbc4c2c78d16a20f3cab1_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":70,"col":24},"end":{"line":70,"col":32},"lines":"    if (!fs.existsSync(fullPath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `objectPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"debc72f74f82ad6764d3b33be11bb0a6be7e8d2477daf9eaafe6a7e36605dac44d64e165af3c592225f005f528b89bd0eb214d1c338ca31bc2281fd6da105c03_0"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":74,"col":33},"end":{"line":74,"col":41},"lines":"    return fs.promises.readFile(fullPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `objectPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"debc72f74f82ad6764d3b33be11bb0a6be7e8d2477daf9eaafe6a7e36605dac44d64e165af3c592225f005f528b89bd0eb214d1c338ca31bc2281fd6da105c03_1"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":78,"col":47},"end":{"line":78,"col":57},"lines":"    const fullPath = path.join(this.basePath, objectPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"213f9f3f0ad1812e6be9d713434ee32a4d8abf32b9caa82422491e215442dd06dd2f23bcda9e8266b28720332fbb242c30d6892a00efbc4c2c78d16a20f3cab1_1"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":80,"col":23},"end":{"line":80,"col":31},"lines":"    if (fs.existsSync(fullPath)) {"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `objectPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"debc72f74f82ad6764d3b33be11bb0a6be7e8d2477daf9eaafe6a7e36605dac44d64e165af3c592225f005f528b89bd0eb214d1c338ca31bc2281fd6da105c03_2"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":81,"col":32},"end":{"line":81,"col":40},"lines":"      await fs.promises.unlink(fullPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `objectPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"debc72f74f82ad6764d3b33be11bb0a6be7e8d2477daf9eaafe6a7e36605dac44d64e165af3c592225f005f528b89bd0eb214d1c338ca31bc2281fd6da105c03_3"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":86,"col":47},"end":{"line":86,"col":57},"lines":"    const fullPath = path.join(this.basePath, objectPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.path-traversal.path-join-resolve-traversal","message":"Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.","severity":"MEDIUM","fingerprint":"213f9f3f0ad1812e6be9d713434ee32a4d8abf32b9caa82422491e215442dd06dd2f23bcda9e8266b28720332fbb242c30d6892a00efbc4c2c78d16a20f3cab1_2"},{"location":{"path":"server/filesystemStorage.ts","start":{"line":87,"col":26},"end":{"line":87,"col":34},"lines":"    return fs.existsSync(fullPath);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.detect-non-literal-fs-filename","message":"Detected that function argument `objectPath` has entered the fs module. An attacker could potentially control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are validated.","severity":"MEDIUM","fingerprint":"debc72f74f82ad6764d3b33be11bb0a6be7e8d2477daf9eaafe6a7e36605dac44d64e165af3c592225f005f528b89bd0eb214d1c338ca31bc2281fd6da105c03_4"},{"location":{"path":"server/migrateAccessTokens.ts","start":{"line":35,"col":23},"end":{"line":35,"col":58},"lines":"        console.error(`Item ${item.id}: Failed to encrypt`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"dd87a0bdf608f03804a468580cb6f02aeeb6bcdea87d763852198df886a71f01c85a861a03da99202efec3ec78059785565188fe9c124db53d5ce8631ce9afae_0"},{"location":{"path":"server/plaidWebhookHandlers.ts","start":{"line":114,"col":21},"end":{"line":114,"col":48},"lines":"        console.log(`Item error for ${item_id}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"73311cc56323aa86f04fdb0b0fda2f2c9f9005a9c65eab36886d941c27d879cb325157747fab9a665270ebb02995f765d8cf59b7bbb4bd6eee77a15852312bf5_0"},{"location":{"path":"server/plaidWebhookHandlers.ts","start":{"line":344,"col":21},"end":{"line":344,"col":78},"lines":"      console.error(`Error syncing transactions for item ${plaidItem.itemId}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"dca764703405b673d459d3024e016011a331af443e6d7170f0f63eeeb9838a406fa327a1191c3a6480ab2966464326cfd1900702d343e59e61d1ff755804ed31_0"},{"location":{"path":"server/replitAuth.ts","start":{"line":293,"col":23},"end":{"line":293,"col":81},"lines":"        console.error(`[Auth] Failed to activate enterprise invite for ${email}:`, (err as Error).message);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"22ab0744ef5a6b3ed566944ecfa39002eb7b7432e7571016efd49c71330893c03f4215bea02f068b702dd5e31ea16329ad649a5ece955e41d047ed87c55167be_0"},{"location":{"path":"server/replitAuth.ts","start":{"line":739,"col":21},"end":{"line":739,"col":80},"lines":"      console.error(`[Auth] Failed to create default admin user ${admin.email}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"d14ce0d92e009028ee6d08ca0afec6c683504948709c540861b5f43aae00fa3ebf088b860c66200b3c0d24daa5998ca251e802954ac305f1a8554b34fe6ea8d0_0"},{"location":{"path":"server/replitAuth.ts","start":{"line":817,"col":21},"end":{"line":817,"col":79},"lines":"      console.error(`[Auth] Failed to create enterprise user ${invitee.email}:`, error);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"3784a602d31e6572ff76963851d693cf6ee2ab6dd6a1c7306de4d44080e331de616e7ff7fca7d4962e023f5876e20f0f127653dc371187d4ca219dffd53be899_0"},{"location":{"path":"server/securityAlerting.ts","start":{"line":98,"col":23},"end":{"line":98,"col":66},"lines":"        console.error(`Failed to send security alert to ${email}:`, emailError);"},"checkId":".config.replit..semgrep.vendored-rules.javascript.lang.security.audit.unsafe-formatstring","message":"Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.","severity":"LOW","fingerprint":"e2d05fcc9054b27f545c6814e498dd692f46a24f558c6128e6b7d9ac21d08062a93b17534df2846bebfad461d22156b15c53d39f2dd90529cdad35efc6781b5b_0"}]}